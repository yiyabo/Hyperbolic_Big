# è¿›åŒ–åŠ¨åŠ›å­¦ä¸å› æœå¹²é¢„æ··åˆæ¡†æ¶ï¼šç”¨äºè›‹ç™½è´¨ç›¸äº’ä½œç”¨é¢„æµ‹

**ç‰ˆæœ¬**: 1.0  
**æ—¥æœŸ**: 2025å¹´10æœˆ  
**ä½œè€…**: Hyperbolic_Bigé¡¹ç›®ç»„  
**ç›®æ ‡æœŸåˆŠ**: Nature / Nature Methods

---

## ğŸ“‹ ç›®å½•

1. [æ ¸å¿ƒåˆ›æ–°ä¸åŠ¨æœº](#1-æ ¸å¿ƒåˆ›æ–°ä¸åŠ¨æœº)
2. [ç†è®ºåŸºç¡€](#2-ç†è®ºåŸºç¡€)
3. [æ–¹æ³•æ¡†æ¶](#3-æ–¹æ³•æ¡†æ¶)
4. [æŠ€æœ¯å®ç°](#4-æŠ€æœ¯å®ç°)
5. [æ•°æ®éœ€æ±‚](#5-æ•°æ®éœ€æ±‚)
6. [å®éªŒè®¾è®¡](#6-å®éªŒè®¾è®¡)
7. [é¢„æœŸç»“æœä¸å½±å“](#7-é¢„æœŸç»“æœä¸å½±å“)
8. [å®æ–½è·¯çº¿å›¾](#8-å®æ–½è·¯çº¿å›¾)
9. [æ½œåœ¨æŒ‘æˆ˜ä¸è§£å†³æ–¹æ¡ˆ](#9-æ½œåœ¨æŒ‘æˆ˜ä¸è§£å†³æ–¹æ¡ˆ)

---

## 1. æ ¸å¿ƒåˆ›æ–°ä¸åŠ¨æœº

### 1.1 ç°æœ‰æ–¹æ³•çš„æ ¹æœ¬ç¼ºé™·

**é—®é¢˜1: é™æ€è§†è§’çš„å±€é™**
```
ç°æœ‰æ–¹æ³•: Protein A + Protein B â†’ PPI (yes/no, static)
ç”Ÿç‰©ç°å®: PPIæ˜¯æ•°äº¿å¹´è¿›åŒ–çš„äº§ç‰©ï¼Œæ˜¯åŠ¨æ€ã€å—çº¦æŸçš„è¿‡ç¨‹
```

- å¿½ç•¥äº†PPIçš„**è¿›åŒ–å†å²**
- æ— æ³•è§£é‡Š**ä¸ºä»€ä¹ˆ**æŸäº›PPIå­˜åœ¨
- æ— æ³•é¢„æµ‹**æœªæ¥**æˆ–**æ–°ç¯å¢ƒ**ä¸‹çš„PPI

**é—®é¢˜2: ç›¸å…³æ€§vså› æœæ€§**
```
è®­ç»ƒæ•°æ®: è§‚å¯Ÿæ€§PPIç½‘ç»œ (correlational)
å®é™…éœ€æ±‚: é¢„æµ‹å¹²é¢„æ•ˆåº” (causal)
         ä¾‹å¦‚ï¼šçªå˜ã€è¯ç‰©ã€ç¯å¢ƒå˜åŒ–
```

- ç°æœ‰æ¨¡å‹å­¦ä¹ çš„æ˜¯**è¡¨é¢å…³è”**
- åœ¨åˆ†å¸ƒå¤–æ•°æ®ï¼ˆOODï¼‰ä¸Šæ³›åŒ–èƒ½åŠ›å·®
- æ— æ³•å›ç­”å¹²é¢„æ€§é—®é¢˜ï¼ˆ"what if"ï¼‰

**é—®é¢˜3: ç¼ºä¹å¯è§£é‡Šçš„ç”Ÿç‰©å­¦æœºåˆ¶**
```
é»‘ç›’é¢„æµ‹ â†’ æ— æ³•ç†è§£ç”Ÿç‰©å­¦åŸç†
         â†’ æ— æ³•æŒ‡å¯¼å®éªŒè®¾è®¡
         â†’ æ— æ³•åº”ç”¨äºè›‹ç™½è´¨å·¥ç¨‹
```

### 1.2 æ ¸å¿ƒåˆ›æ–°ï¼šä»"é¢„æµ‹å­˜åœ¨"åˆ°"ç†è§£æœºåˆ¶"

> **Central Hypothesis (æ ¸å¿ƒå‡è®¾):**  
> PPIä¸æ˜¯ç‹¬ç«‹çš„äºŒå…ƒæ ‡ç­¾ï¼Œè€Œæ˜¯è¿›åŒ–åŠ¨åŠ›ç³»ç»Ÿåœ¨å› æœçº¦æŸä¸‹çš„æ¶Œç°å±æ€§ã€‚é€šè¿‡è”åˆå»ºæ¨¡è¿›åŒ–è½¨è¿¹ä¸å› æœæœºåˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥é¢„æµ‹ã€è§£é‡Šå¹¶æ“çºµPPIã€‚

#### ä¸‰ä¸ªå…³é”®è½¬å˜

| ä¼ ç»ŸèŒƒå¼ | æ–°èŒƒå¼ | å½±å“ |
|---------|--------|------|
| é™æ€é¢„æµ‹ | åŠ¨æ€å»ºæ¨¡ | ç†è§£PPIçš„è¿›åŒ–å†å²å’Œæœªæ¥ |
| å­¦ä¹ ç›¸å…³æ€§ | æ¨æ–­å› æœæ€§ | é¢„æµ‹å¹²é¢„æ•ˆåº”ï¼ˆçªå˜ã€è¯ç‰©ï¼‰|
| é»‘ç›’æ¨¡å‹ | æœºåˆ¶æ¨¡å‹ | å¯è§£é‡Šã€å¯æŒ‡å¯¼å®éªŒ |

### 1.3 ä¸ºä»€ä¹ˆæ˜¯Natureçº§åˆ«ï¼Ÿ

**ç†è®ºè´¡çŒ®**
- é¦–æ¬¡å°†**è¿›åŒ–ç”Ÿç‰©å­¦ã€å› æœæ¨æ–­ã€æ·±åº¦å­¦ä¹ **ç»Ÿä¸€åˆ°å•ä¸€æ¡†æ¶
- æå‡ºPPIçš„**åŠ¨åŠ›ç³»ç»Ÿç†è®º**
- è§£å†³é•¿æœŸæ‚¬è€Œæœªå†³çš„é—®é¢˜ï¼šå¦‚ä½•ä»è§‚å¯Ÿæ€§æ•°æ®æ¨æ–­å› æœæœºåˆ¶

**æ–¹æ³•åˆ›æ–°**
- ä¸æ˜¯"æ‹¼è£…ç°æœ‰æ¨¡å—"ï¼Œè€Œæ˜¯**å…¨æ–°èŒƒå¼**
- åˆ©ç”¨è¿›åŒ– = è‡ªç„¶çš„é•¿æœŸå¹²é¢„å®éªŒ
- é¦–ä¸ªèƒ½é¢„æµ‹**åäº‹å®PPI**çš„æ¨¡å‹

**ç”Ÿç‰©å­¦å½±å“**
- å›ç­”æ ¹æœ¬é—®é¢˜ï¼šPPIçš„**è¿›åŒ–èµ·æº**å’Œ**ç»´æŒæœºåˆ¶**
- å‘ç°æ–°çš„ç”Ÿç‰©å­¦è§„å¾‹ï¼ˆè¿›åŒ–çº¦æŸæ¨¡å¼ï¼‰
- å®é™…åº”ç”¨ï¼šè›‹ç™½è´¨è®¾è®¡ã€ç–¾ç—…æœºåˆ¶ã€è¯ç‰©é¶ç‚¹

**æŠ€æœ¯å½±å“**
- å¯æ¨å¹¿åˆ°å…¶ä»–ç”Ÿç‰©ç½‘ç»œï¼ˆåŸºå› è°ƒæ§ã€ä»£è°¢ï¼‰
- ä¸º"å¦‚ä½•ä»è§‚å¯Ÿæ€§æ•°æ®å­¦ä¹ å› æœæ¨¡å‹"æä¾›èŒƒä¾‹
- å¼€åˆ›"è¿›åŒ–æ·±åº¦å­¦ä¹ "æ–°é¢†åŸŸ

---

## 2. ç†è®ºåŸºç¡€

### 2.1 PPIçš„è¿›åŒ–åŠ¨åŠ›å­¦æ¨¡å‹

#### 2.1.1 æ•°å­¦å½¢å¼åŒ–

å°†PPIè§†ä¸ºè¿ç»­æ—¶é—´é©¬å°”å¯å¤«è¿‡ç¨‹ï¼š

$$
\frac{dP_{AB}(t)}{dt} = f(S_A(t), S_B(t), \theta_{\text{evo}}, \theta_{\text{sel}})
$$

å…¶ä¸­ï¼š
- $P_{AB}(t)$: æ—¶é—´$t$æ—¶è›‹ç™½Aå’ŒBçš„ç›¸äº’ä½œç”¨æ¦‚ç‡/å¼ºåº¦
- $S_A(t), S_B(t)$: Aå’ŒBçš„åºåˆ—åœ¨æ—¶é—´$t$çš„çŠ¶æ€
- $\theta_{\text{evo}}$: è¿›åŒ–è¿‡ç¨‹å‚æ•°ï¼ˆçªå˜ç‡ã€é‡ç»„ç‡ç­‰ï¼‰
- $\theta_{\text{sel}}$: é€‰æ‹©å‹åŠ›å‚æ•°ï¼ˆä»æ•°æ®å­¦ä¹ ï¼‰

#### 2.1.2 ç”Ÿç‰©å­¦è§£é‡Š

**è¿›åŒ–è½¨è¿¹çš„ä¸‰ä¸ªé˜¶æ®µ**ï¼š
```
1. ç¥–å…ˆçŠ¶æ€ (t=0): å…±åŒç¥–å…ˆçš„åºåˆ—å’ŒPPIçŠ¶æ€
2. è¿›åŒ–è¿‡ç¨‹ (0<t<T): çªå˜ç§¯ç´¯ + é€‰æ‹©ç­›é€‰
3. ç°ä»£çŠ¶æ€ (t=T): è§‚å¯Ÿåˆ°çš„ç°ä»£ç‰©ç§PPI
```

**å…³é”®æ´å¯Ÿ**ï¼š
- PPIçš„å­˜åœ¨ä¸æ˜¯éšæœºçš„ï¼Œè€Œæ˜¯**è¿›åŒ–é€‰æ‹©**çš„ç»“æœ
- ä¿å®ˆçš„PPI â†’ å¼ºåŠŸèƒ½çº¦æŸ â†’ é«˜è´Ÿé€‰æ‹©
- divergent PPI â†’ å¼±çº¦æŸæˆ–æ­£é€‰æ‹©

#### 2.1.3 å…±è¿›åŒ–è€¦åˆ

ä¸¤ä¸ªè›‹ç™½è´¨çš„è¿›åŒ–ä¸æ˜¯ç‹¬ç«‹çš„ï¼š

$$
P(S_A(t), S_B(t) | \text{PPI exists}) \neq P(S_A(t)) \cdot P(S_B(t))
$$

**ååŒè¿›åŒ–æ¨¡å¼**ï¼š
- **è¡¥å¿çªå˜** (Compensatory mutations): Açš„çªå˜è¢«Bçš„çªå˜è¡¥å¿
- **å…±é€‚åº”** (Co-adaptation): ç•Œé¢æ®‹åŸºååŒä¼˜åŒ–
- **åŠŸèƒ½è€¦åˆ** (Functional coupling): ä¿æŒç›¸äº’ä½œç”¨å¼ºåº¦

**æ•°å­¦å»ºæ¨¡**ï¼šPottsæ¨¡å‹
$$
E(S_A, S_B) = \sum_{i \in A, j \in B} J_{ij}(s_i, s_j) + \sum_{i} h_i(s_i)
$$

### 2.2 å› æœæ¨æ–­æ¡†æ¶

#### 2.2.1 PPIçš„å› æœå›¾ (Causal DAG)

```
åºåˆ—A â†’ ç»“æ„A â†˜
                ç•Œé¢ â†’ äº²å’ŒåŠ› â†˜
åºåˆ—B â†’ ç»“æ„B â†—              PPI
                              â†—
ç¨³å®šæ€§A â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
ç¨³å®šæ€§B â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  â†‘
è¿›åŒ–å†å²ï¼ˆæ··æ‚å› ç´ ï¼‰
```

**å› æœå…³ç³»**ï¼š
- åºåˆ— â†’ ç»“æ„ â†’ ç•Œé¢ â†’ äº²å’ŒåŠ› â†’ PPI
- è¿›åŒ–å†å²æ˜¯**æ··æ‚å› ç´ ** (confounder)

#### 2.2.2 å¹²é¢„ (Intervention)

**å½¢å¼åŒ–å®šä¹‰**ï¼š
- è§‚å¯Ÿæ€§åˆ†å¸ƒ: $P(PPI | A, B)$
- å¹²é¢„ååˆ†å¸ƒ: $P(PPI | do(A'), B)$ ï¼ˆå¼ºåˆ¶æ”¹å˜Aåˆ°A'ï¼‰

**å¹²é¢„ç±»å‹**ï¼š
1. **åºåˆ—å¹²é¢„**: ç‚¹çªå˜ã€æ’å…¥ã€ç¼ºå¤±
2. **è¡¨è¾¾å¹²é¢„**: CRISPRæ•²é™¤/æ•²ä½
3. **ç¯å¢ƒå¹²é¢„**: pHã€æ¸©åº¦ã€è¯ç‰©
4. **è¿›åŒ–å¹²é¢„**: ç‰©ç§åˆ†åŒ–ã€é€‰æ‹©å‹åŠ›æ”¹å˜

#### 2.2.3 åäº‹å®æ¨ç† (Counterfactual Reasoning)

**åäº‹å®é—®é¢˜**ï¼š
- "å¦‚æœè›‹ç™½Açš„æ®‹åŸº123çªå˜ä¸ºä¸™æ°¨é…¸ï¼ŒPPIä¼šå¦‚ä½•å˜åŒ–ï¼Ÿ"
- "å¦‚æœæ²¡æœ‰è¿›åŒ–å‹åŠ›Xï¼Œè¿™ä¸ªPPIè¿˜ä¼šå­˜åœ¨å—ï¼Ÿ"

**ä¸‰æ­¥æ¨ç†** (Pearl's Ladder of Causation):
```
1. Association (å…³è”): P(PPI|A,B) 
   â†’ ç°æœ‰æ–¹æ³•èƒ½åš

2. Intervention (å¹²é¢„): P(PPI|do(A'))
   â†’ æœ¬æ–¹æ³•çš„æ ¸å¿ƒ

3. Counterfactual (åäº‹å®): P(PPI_A' | A, B, PPI_observed)
   â†’ æœ€é«˜å±‚æ¬¡çš„å› æœæ¨ç†
```

### 2.3 è¿›åŒ–ä½œä¸ºè‡ªç„¶çš„å¹²é¢„å®éªŒ

**å…³é”®æ´å¯Ÿ**ï¼š
> æ¯æ¬¡ç‰©ç§åˆ†åŒ– = ä¸€æ¬¡è‡ªç„¶çš„"å¹²é¢„å®éªŒ"  
> æ•°ç™¾ä¸‡å¹´çš„è¿›åŒ– = å¤§è§„æ¨¡çš„"A/Bæµ‹è¯•"

#### 2.3.1 åˆ©ç”¨å¤šç‰©ç§æ•°æ®è¿›è¡Œå› æœå‘ç°

**è‡ªç„¶å®éªŒçš„ä¼˜åŠ¿**ï¼š
- æ—¶é—´å°ºåº¦é•¿ï¼ˆçœŸå®çš„é•¿æœŸæ•ˆåº”ï¼‰
- é‡å¤æ¬¡æ•°å¤šï¼ˆå¤šä¸ªç‹¬ç«‹è¿›åŒ–è°±ç³»ï¼‰
- "éšæœºåŒ–"ï¼ˆé—ä¼ æ¼‚å˜ï¼‰

**æŒ‘æˆ˜**ï¼š
- è§‚å¯Ÿä¸åˆ°ç¥–å…ˆçŠ¶æ€ï¼ˆéœ€è¦é‡å»ºï¼‰
- å­˜åœ¨æ··æ‚å› ç´ ï¼ˆèƒŒæ™¯çªå˜ï¼‰
- é€‰æ‹©åå·®ï¼ˆåªèƒ½è§‚å¯Ÿåˆ°å­˜æ´»çš„è°±ç³»ï¼‰

#### 2.3.2 ä»è¿›åŒ–è½¨è¿¹æ¨æ–­å› æœæ•ˆåº”

**æ ¸å¿ƒæ€æƒ³**ï¼šå¦‚æœçªå˜Xæ€»æ˜¯ä¼´éšPPIçš„å˜åŒ–ï¼Œä¸”è¿™ä¸ªæ¨¡å¼åœ¨å¤šä¸ªç‹¬ç«‹è°±ç³»é‡å¤å‡ºç°ï¼Œé‚£ä¹ˆXå¾ˆå¯èƒ½æ˜¯PPIçš„**å› æœå†³å®šå› ç´ **ã€‚

**æ•°å­¦å½¢å¼**ï¼š
$$
\text{Causal Effect} = \mathbb{E}[PPI(t+1) | \text{Mutation X at t}] - \mathbb{E}[PPI(t+1) | \text{No Mutation}]
$$

åœ¨å¤šä¸ªè¿›åŒ–è°±ç³»ä¸Šå¹³å‡ï¼Œæ§åˆ¶æ··æ‚å› ç´ ã€‚

---

## 3. æ–¹æ³•æ¡†æ¶

### 3.1 æ•´ä½“æ¶æ„

```
è¾“å…¥: 
  - å¤šç‰©ç§åºåˆ—æ•°æ® + ç‰©ç§æ ‘
  - ç°ä»£PPIç½‘ç»œ
  - (å¯é€‰) å¹²é¢„å®éªŒæ•°æ®

     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ¨¡å—1: è¿›åŒ–è½¨è¿¹é‡å»º                     â”‚
â”‚  - ç¥–å…ˆåºåˆ—é‡å»º                          â”‚
â”‚  - PPIçŠ¶æ€æ¼”åŒ–å»ºæ¨¡                       â”‚
â”‚  - å…±è¿›åŒ–è€¦åˆå­¦ä¹                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ¨¡å—2: å› æœå›¾å­¦ä¹                        â”‚
â”‚  - ä»è¿›åŒ–æ•°æ®å‘ç°å› æœå…³ç³»                 â”‚
â”‚  - å­¦ä¹ å› æœå›¾ç»“æ„                        â”‚
â”‚  - ä¼°è®¡å› æœæ•ˆåº”å¤§å°                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ¨¡å—3: å¹²é¢„é¢„æµ‹                         â”‚
â”‚  - åºåˆ—å¹²é¢„ â†’ PPIå˜åŒ–                    â”‚
â”‚  - åäº‹å®æ¨ç†                            â”‚
â”‚  - ä¸ç¡®å®šæ€§é‡åŒ–                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â†“
è¾“å‡º:
  - PPIé¢„æµ‹ (ç°ä»£ + è·¨ç‰©ç§)
  - å¹²é¢„æ•ˆåº”é¢„æµ‹ (çªå˜ã€è¯ç‰©)
  - è¿›åŒ–çº¦æŸå›¾è°±
  - å› æœè§£é‡Š
```

### 3.2 æ¨¡å—1: è¿›åŒ–è½¨è¿¹é‡å»º

#### 3.2.1 ç¥–å…ˆåºåˆ—é‡å»º (Ancestral Sequence Reconstruction)

**è¾“å…¥**ï¼š
- ç°ä»£ç‰©ç§åºåˆ—: $\{S_A^{(1)}, S_A^{(2)}, \ldots, S_A^{(N)}\}$
- ç‰©ç§æ ‘: $\mathcal{T}$ (æ‹“æ‰‘ + åˆ†æ”¯é•¿åº¦)

**è¾“å‡º**ï¼š
- ç¥–å…ˆåºåˆ—: $\{S_A^{\text{anc}_1}, S_A^{\text{anc}_2}, \ldots\}$ (æ¯ä¸ªå†…éƒ¨èŠ‚ç‚¹)

**æ–¹æ³•**ï¼šè”åˆæœ€å¤§ä¼¼ç„¶ + æ·±åº¦å­¦ä¹ 

**ä¼ ç»Ÿæ–¹æ³•** (PAML, IQ-TREE):
$$
S^{\text{anc}} = \arg\max_{S} P(S | \text{descendants}, \mathcal{T}, \theta_{\text{evo}})
$$

**é—®é¢˜**ï¼š
- å‡è®¾ç®€å•çš„è¿›åŒ–æ¨¡å‹ï¼ˆå¦‚GTRï¼‰
- ä¸è€ƒè™‘PPIçº¦æŸ
- å¿½ç•¥å…±è¿›åŒ–

**æˆ‘ä»¬çš„æ”¹è¿›**ï¼šDeep Ancestral Reconstruction
```python
class DeepAncestralReconstructor(nn.Module):
    def __init__(self):
        self.sequence_encoder = ESM2()  # é¢„è®­ç»ƒPLM
        self.tree_encoder = TreeLSTM()  # ç¼–ç ç‰©ç§æ ‘
        self.evolution_model = NeuralODE()  # è¿ç»­æ—¶é—´è¿›åŒ–
        self.ppi_constraint = PPIAwareDecoder()  # è€ƒè™‘PPIçº¦æŸ
    
    def forward(self, modern_sequences, tree, ppi_network):
        # 1. ç¼–ç ç°ä»£åºåˆ—
        seq_embeddings = self.sequence_encoder(modern_sequences)
        
        # 2. ç¼–ç ç‰©ç§æ ‘ç»“æ„
        tree_context = self.tree_encoder(tree)
        
        # 3. åå‘ä¼ æ’­ï¼šä»å¶èŠ‚ç‚¹æ¨æ–­ç¥–å…ˆ
        ancestral_embeddings = self.backward_pass(
            seq_embeddings, tree_context
        )
        
        # 4. è€ƒè™‘PPIçº¦æŸï¼šå¦‚æœA-Båœ¨ç°ä»£æœ‰PPIï¼Œ
        #    ç¥–å…ˆä¹Ÿåº”è¯¥æœ‰å…¼å®¹çš„ç•Œé¢
        ancestral_embeddings = self.ppi_constraint(
            ancestral_embeddings, ppi_network
        )
        
        # 5. è§£ç ä¸ºç¥–å…ˆåºåˆ—ï¼ˆé‡‡æ ·å¤šä¸ªå¯èƒ½çš„ç¥–å…ˆï¼‰
        ancestral_sequences = self.decoder(ancestral_embeddings)
        
        return ancestral_sequences  # åˆ†å¸ƒï¼Œä¸æ˜¯å•ç‚¹ä¼°è®¡
```

**åˆ›æ–°ç‚¹**ï¼š
- âœ… åˆ©ç”¨PLMçš„è¿›åŒ–çŸ¥è¯†
- âœ… åŒæ—¶è€ƒè™‘åºåˆ—å’ŒPPIçº¦æŸ
- âœ… è¾“å‡ºä¸ç¡®å®šæ€§ï¼ˆç¥–å…ˆåºåˆ—åˆ†å¸ƒï¼‰
- âœ… ç«¯åˆ°ç«¯å¯å¾®åˆ†ï¼ˆä¸ä¸‹æ¸¸ä»»åŠ¡è”åˆè®­ç»ƒï¼‰

#### 3.2.2 PPIçŠ¶æ€æ¼”åŒ–å»ºæ¨¡

**ç›®æ ‡**ï¼šæ²¿è¿›åŒ–æ ‘è¿½è¸ªPPIçŠ¶æ€çš„å˜åŒ–

**æ¨¡å‹**ï¼šè¿ç»­æ—¶é—´é©¬å°”å¯å¤«é“¾ + ç¥ç»ç½‘ç»œ

$$
P(\text{PPI}_{AB}(t+dt) = 1 | \text{state}(t)) = \lambda_{\text{gain}}(t) \cdot dt
$$
$$
P(\text{PPI}_{AB}(t+dt) = 0 | \text{state}(t)) = \lambda_{\text{loss}}(t) \cdot dt
$$

å…¶ä¸­è½¬ç§»ç‡ç”±ç¥ç»ç½‘ç»œå‚æ•°åŒ–ï¼š

```python
class PPIEvolutionModel(nn.Module):
    def forward(self, seq_A_t, seq_B_t, ppi_t, branch_length):
        # è®¡ç®—PPIè·å¾—/ä¸¢å¤±çš„é€Ÿç‡
        lambda_gain = self.gain_network(seq_A_t, seq_B_t, context)
        lambda_loss = self.loss_network(seq_A_t, seq_B_t, context)
        
        # æ²¿åˆ†æ”¯æ¼”åŒ–PPIçŠ¶æ€
        ppi_t_plus_dt = self.evolve(ppi_t, lambda_gain, lambda_loss, 
                                     branch_length)
        
        return ppi_t_plus_dt, lambda_gain, lambda_loss
```

**å­¦ä¹ ç›®æ ‡**ï¼š
$$
\mathcal{L}_{\text{evo}} = \sum_{\text{branches}} -\log P(\text{PPI}_{\text{child}} | \text{PPI}_{\text{parent}}, \text{branch})
$$

#### 3.2.3 å…±è¿›åŒ–è€¦åˆå­¦ä¹ 

**é—®é¢˜**ï¼šä¸¤ä¸ªè›‹ç™½è´¨çš„è¿›åŒ–è½¨è¿¹ç›¸äº’è€¦åˆ

**è§£å†³æ–¹æ¡ˆ**ï¼šè”åˆå»ºæ¨¡

```python
class CoevolutionModel(nn.Module):
    def __init__(self):
        # Pottsæ¨¡å‹å‚æ•°ï¼ˆæ®‹åŸº-æ®‹åŸºè€¦åˆï¼‰
        self.coupling_matrix = nn.Parameter(torch.randn(L_A, L_B, 20, 20))
        self.fields = nn.Parameter(torch.randn(L_A + L_B, 20))
    
    def energy(self, seq_A, seq_B):
        # è®¡ç®—åºåˆ—å¯¹çš„èƒ½é‡ï¼ˆè¶Šä½è¶Šç¨³å®šï¼‰
        E_coupling = sum(self.coupling_matrix[i,j, seq_A[i], seq_B[j]] 
                        for i in range(L_A) for j in range(L_B))
        E_fields = sum(self.fields[i, seq_A[i]] for i in range(L_A)) + \
                   sum(self.fields[j+L_A, seq_B[j]] for j in range(L_B))
        return E_coupling + E_fields
    
    def coevolution_pressure(self, seq_A, seq_B):
        # è®¡ç®—å…±è¿›åŒ–å‹åŠ›ï¼ˆæ¢¯åº¦ï¼‰
        energy = self.energy(seq_A, seq_B)
        grad_A = torch.autograd.grad(energy, seq_A)[0]
        grad_B = torch.autograd.grad(energy, seq_B)[0]
        return grad_A, grad_B
```

**æ•´åˆåˆ°è¿›åŒ–æ¨¡å‹**ï¼š
- å…±è¿›åŒ–èƒ½é‡ â†’ å½±å“çªå˜æ¥å—ç‡
- è¡¥å¿çªå˜æ›´å®¹æ˜“è¢«å›ºå®š
- ç ´åç•Œé¢çš„çªå˜è¢«é€‰æ‹©æ¸…é™¤

### 3.3 æ¨¡å—2: å› æœå›¾å­¦ä¹ 

#### 3.3.1 ä»è¿›åŒ–æ•°æ®å‘ç°å› æœå…³ç³»

**æ ¸å¿ƒæ€æƒ³**ï¼šæ—¶é—´é¡ºåº + é‡å¤è§‚å¯Ÿ â†’ å› æœæ¨æ–­

**ç®—æ³•**ï¼šEvolutionary Causal Discovery

```python
class EvolutionaryCausalDiscovery:
    def discover_causal_graph(self, evolutionary_trajectories):
        """
        ä»å¤šä¸ªè¿›åŒ–è°±ç³»å‘ç°å› æœå…³ç³»
        
        è¾“å…¥: 
          - evolutionary_trajectories: List of (mutations, ppi_changes)
            æ¯ä¸ªè°±ç³»æ˜¯ä¸€ä¸ªæ—¶é—´åºåˆ—
        
        è¾“å‡º:
          - causal_graph: DAGè¡¨ç¤ºå› æœå…³ç³»
          - effect_sizes: å› æœæ•ˆåº”å¤§å°
        """
        
        # 1. å¯¹é½å¤šä¸ªè°±ç³»ï¼ˆå¤„ç†ä¸åŒçš„è¿›åŒ–é€Ÿç‡ï¼‰
        aligned_trajectories = self.align_trajectories(
            evolutionary_trajectories
        )
        
        # 2. è¯†åˆ«é‡å¤å‡ºç°çš„æ¨¡å¼
        # "çªå˜X â†’ PPIå˜åŒ–"åœ¨å¤šä¸ªç‹¬ç«‹è°±ç³»å‡ºç°
        recurring_patterns = self.find_recurring_patterns(
            aligned_trajectories
        )
        
        # 3. æ§åˆ¶æ··æ‚å› ç´ ï¼ˆèƒŒæ™¯çªå˜ï¼‰
        causal_effects = {}
        for pattern in recurring_patterns:
            effect = self.estimate_causal_effect(
                pattern, 
                adjust_for_confounders=True  # å€¾å‘è¯„åˆ†åŒ¹é…
            )
            if effect.is_significant():
                causal_effects[pattern.mutation] = effect
        
        # 4. æ„å»ºå› æœå›¾
        causal_graph = self.build_dag(causal_effects)
        
        return causal_graph, causal_effects
```

**ç»Ÿè®¡æ–¹æ³•**ï¼š
- **å€¾å‘è¯„åˆ†åŒ¹é…** (Propensity Score Matching): æ§åˆ¶èƒŒæ™¯çªå˜
- **å·¥å…·å˜é‡** (Instrumental Variables): åˆ©ç”¨é—ä¼ æ¼‚å˜ä½œä¸º"éšæœºåŒ–"
- **æ–­ç‚¹å›å½’** (Regression Discontinuity): åˆ©ç”¨é€‰æ‹©å‹åŠ›çš„çªå˜é˜ˆå€¼

#### 3.3.2 ç»“æ„å› æœæ¨¡å‹ (Structural Causal Model)

**å®šä¹‰PPIçš„SCM**ï¼š

$$
\begin{align}
\text{Structure}_A &= f_1(\text{Sequence}_A, U_1) \\
\text{Structure}_B &= f_2(\text{Sequence}_B, U_2) \\
\text{Interface} &= f_3(\text{Structure}_A, \text{Structure}_B, U_3) \\
\text{PPI} &= f_4(\text{Interface}, \text{Stability}_A, \text{Stability}_B, U_4)
\end{align}
$$

å…¶ä¸­$U_i$æ˜¯æœªè§‚å¯Ÿçš„å¤–ç”Ÿå˜é‡ï¼ˆå™ªå£°ï¼‰

**ç”¨ç¥ç»ç½‘ç»œå‚æ•°åŒ–**ï¼š

```python
class StructuralCausalModel(nn.Module):
    def __init__(self):
        self.f1 = SequenceToStructure()  # å¯ä»¥ç”¨AlphaFold
        self.f2 = SequenceToStructure()
        self.f3 = InterfacePredictor()
        self.f4 = PPIPredictor()
    
    def forward(self, seq_A, seq_B, noise=None):
        # æ­£å‘å› æœé“¾
        struct_A = self.f1(seq_A, noise.U1 if noise else None)
        struct_B = self.f2(seq_B, noise.U2 if noise else None)
        interface = self.f3(struct_A, struct_B, noise.U3 if noise else None)
        ppi = self.f4(interface, struct_A, struct_B, noise.U4 if noise else None)
        return ppi
    
    def intervene(self, seq_A, seq_B, intervention):
        """
        å¹²é¢„ï¼šå¼ºåˆ¶æ”¹å˜æŸä¸ªå˜é‡
        """
        if intervention.target == "seq_A":
            seq_A = intervention.value  # do(Sequence_A = new_value)
        
        # é‡æ–°è®¡ç®—ä¸‹æ¸¸å˜é‡ï¼ˆä¸æ”¹å˜å™ªå£°ï¼‰
        return self.forward(seq_A, seq_B, noise=intervention.noise)
    
    def counterfactual(self, seq_A, seq_B, ppi_observed, intervention):
        """
        åäº‹å®æ¨ç†ï¼š
        1. åå‘æ¨æ–­å™ªå£°ï¼ˆä»è§‚å¯Ÿæ•°æ®ï¼‰
        2. å‰å‘é¢„æµ‹åäº‹å®ä¸–ç•Œ
        """
        # æ­¥éª¤1: åæ¼”å™ªå£°
        noise = self.abduction(seq_A, seq_B, ppi_observed)
        
        # æ­¥éª¤2: å¹²é¢„
        seq_A_cf = intervention.value if intervention.target == "seq_A" else seq_A
        seq_B_cf = intervention.value if intervention.target == "seq_B" else seq_B
        
        # æ­¥éª¤3: é¢„æµ‹åäº‹å®PPIï¼ˆä½¿ç”¨ç›¸åŒçš„å™ªå£°ï¼‰
        ppi_cf = self.forward(seq_A_cf, seq_B_cf, noise=noise)
        
        return ppi_cf
```

#### 3.3.3 å› æœæ•ˆåº”ä¼°è®¡

**å¹³å‡å› æœæ•ˆåº”** (Average Causal Effect, ACE):
$$
\text{ACE} = \mathbb{E}[\text{PPI}(do(\text{Mutation}=1))] - \mathbb{E}[\text{PPI}(do(\text{Mutation}=0))]
$$

**æ¡ä»¶å› æœæ•ˆåº”** (Conditional ACE):
$$
\text{CACE}(c) = \mathbb{E}[\text{PPI}(do(M=1)) - \text{PPI}(do(M=0)) | \text{Context}=c]
$$

ä¾‹å¦‚ï¼šçªå˜å¯¹PPIçš„å½±å“**ä¾èµ–äº**è¿›åŒ–èƒŒæ™¯ã€å®¶æ—ã€ç‰©ç§

**å®ç°**ï¼š

```python
def estimate_causal_effect(self, mutation, data):
    # ä½¿ç”¨åŒé‡æœºå™¨å­¦ä¹  (Double ML) æ¶ˆé™¤æ··æ‚åå·®
    
    # æ­¥éª¤1: é¢„æµ‹å¤„ç†å˜é‡ï¼ˆçªå˜ï¼‰
    propensity = self.predict_propensity(mutation, data.confounders)
    
    # æ­¥éª¤2: é¢„æµ‹ç»“æœå˜é‡ï¼ˆPPIï¼‰
    outcome_pred = self.predict_outcome(data.confounders)
    
    # æ­¥éª¤3: è®¡ç®—æ®‹å·®
    treatment_residual = mutation - propensity
    outcome_residual = data.ppi - outcome_pred
    
    # æ­¥éª¤4: å›å½’æ®‹å·®ï¼ˆå¾—åˆ°æ— åä¼°è®¡ï¼‰
    causal_effect = np.cov(treatment_residual, outcome_residual)[0,1] / \
                    np.var(treatment_residual)
    
    return causal_effect
```

### 3.4 æ¨¡å—3: å¹²é¢„é¢„æµ‹

#### 3.4.1 åºåˆ—å¹²é¢„é¢„æµ‹

**ä»»åŠ¡**ï¼šç»™å®šçªå˜ï¼Œé¢„æµ‹PPIå˜åŒ–

```python
class InterventionPredictor(nn.Module):
    def __init__(self, scm):
        self.scm = scm  # ç»“æ„å› æœæ¨¡å‹
        self.evolution_model = PPIEvolutionModel()  # è¿›åŒ–çº¦æŸ
    
    def predict_mutation_effect(self, seq_A, seq_B, ppi_obs, mutation):
        """
        é¢„æµ‹ç‚¹çªå˜çš„æ•ˆåº”
        
        è¾“å…¥:
          - seq_A, seq_B: é‡ç”Ÿå‹åºåˆ—
          - ppi_obs: è§‚å¯Ÿåˆ°çš„é‡ç”Ÿå‹PPI
          - mutation: (protein, position, new_aa)
        
        è¾“å‡º:
          - delta_ppi: PPIå˜åŒ–
          - confidence: ç½®ä¿¡åŒºé—´
          - mechanism: å› æœè·¯å¾„ï¼ˆå¯è§£é‡Šæ€§ï¼‰
        """
        
        # 1. åäº‹å®æ¨ç†ï¼šå¦‚æœçªå˜å‘ç”Ÿ
        seq_A_mut = self.apply_mutation(seq_A, mutation)
        ppi_cf = self.scm.counterfactual(
            seq_A, seq_B, ppi_obs, 
            intervention=Intervention("seq_A", seq_A_mut)
        )
        
        # 2. è€ƒè™‘è¿›åŒ–çº¦æŸï¼šè¿™ä¸ªçªå˜åœ¨è¿›åŒ–ä¸Šå¯è¡Œå—ï¼Ÿ
        evo_plausibility = self.evolution_model.mutation_fitness(
            seq_A, mutation
        )
        
        # 3. å¤šè·¯å¾„å› æœæ•ˆåº”åˆ†è§£
        effects = self.decompose_causal_paths(seq_A, seq_A_mut, ppi_obs)
        # effects = {
        #   'structure_change': 0.3,  # ç»“æ„æ”¹å˜çš„è´¡çŒ®
        #   'stability_change': -0.1, # ç¨³å®šæ€§çš„è´¡çŒ®
        #   'interface_change': 0.5,  # ç•Œé¢çš„è´¡çŒ®
        # }
        
        # 4. ä¸ç¡®å®šæ€§é‡åŒ–ï¼ˆè´å¶æ–¯ï¼‰
        ppi_cf_samples = self.sample_counterfactual(
            seq_A, seq_B, ppi_obs, mutation, n_samples=1000
        )
        confidence_interval = np.percentile(ppi_cf_samples, [2.5, 97.5])
        
        return {
            'delta_ppi': ppi_cf - ppi_obs,
            'confidence_interval': confidence_interval,
            'causal_mechanism': effects,
            'evolutionary_plausibility': evo_plausibility
        }
```

#### 3.4.2 è¯ç‰©å¹²é¢„é¢„æµ‹

**æ‰©å±•åˆ°å°åˆ†å­å¹²é¢„**ï¼š

```python
class DrugInterventionPredictor:
    def predict_drug_effect(self, protein_A, protein_B, drug):
        """
        é¢„æµ‹å°åˆ†å­è¯ç‰©å¯¹PPIçš„å½±å“
        
        å‡è®¾ï¼šè¯ç‰©é€šè¿‡æ”¹å˜è›‹ç™½è´¨çš„æ„è±¡/ç¨³å®šæ€§æ¥å½±å“PPI
        """
        
        # 1. é¢„æµ‹è¯ç‰©ç»“åˆä½ç‚¹å’Œäº²å’ŒåŠ›
        binding_site, affinity = self.predict_drug_binding(protein_A, drug)
        
        # 2. é¢„æµ‹è¯ç‰©ç»“åˆåçš„æ„è±¡å˜åŒ–
        conformational_change = self.predict_conformational_change(
            protein_A, drug, binding_site
        )
        
        # 3. å› æœé“¾ï¼šè¯ç‰© â†’ æ„è±¡ â†’ ç•Œé¢ â†’ PPI
        ppi_change = self.scm.intervene(
            protein_A, protein_B,
            intervention=Intervention("conformation_A", conformational_change)
        )
        
        return ppi_change
```

#### 3.4.3 è¿›åŒ–å¤–æ¨é¢„æµ‹

**ä»»åŠ¡**ï¼šé¢„æµ‹æ–°ç‰©ç§/æ–°ç¯å¢ƒä¸‹çš„PPI

```python
def predict_ppi_in_new_species(self, protein_A, protein_B, target_species):
    """
    é¢„æµ‹PPIåœ¨æ–°ç‰©ç§ä¸­æ˜¯å¦å­˜åœ¨
    
    æ€è·¯ï¼š
    1. æ‰¾åˆ°ä¸ç›®æ ‡ç‰©ç§æœ€è¿‘çš„å·²çŸ¥ç‰©ç§
    2. åˆ©ç”¨è¿›åŒ–æ¨¡å‹"å¤–æ¨"åˆ°æ–°ç‰©ç§
    3. è€ƒè™‘ç‰©ç§ç‰¹å¼‚çš„é€‰æ‹©å‹åŠ›
    """
    
    # 1. åœ¨ç‰©ç§æ ‘ä¸Šå®šä½
    closest_species = self.find_closest_species(target_species)
    evolutionary_distance = self.compute_distance(closest_species, target_species)
    
    # 2. æ¨¡æ‹Ÿè¿›åŒ–è¿‡ç¨‹
    seq_A_target = self.evolve_sequence(
        protein_A, evolutionary_distance, target_species.selection_pressure
    )
    seq_B_target = self.evolve_sequence(
        protein_B, evolutionary_distance, target_species.selection_pressure
    )
    
    # 3. é¢„æµ‹ç›®æ ‡ç‰©ç§çš„PPI
    ppi_target = self.scm.forward(seq_A_target, seq_B_target)
    
    # 4. è¯„ä¼°é¢„æµ‹çš„ä¸ç¡®å®šæ€§ï¼ˆè¿›åŒ–éšæœºæ€§ï¼‰
    uncertainty = self.evolutionary_uncertainty(evolutionary_distance)
    
    return ppi_target, uncertainty
```

---

## 4. æŠ€æœ¯å®ç°

### 4.1 æ·±åº¦å­¦ä¹ æ¶æ„

#### 4.1.1 æ•´ä½“æ¶æ„å›¾

```
è¾“å…¥å±‚:
â”œâ”€â”€ åºåˆ—æ•°æ® (å¤šç‰©ç§)
â”œâ”€â”€ ç‰©ç§æ ‘
â””â”€â”€ PPIç½‘ç»œ

ç¼–ç å±‚:
â”œâ”€â”€ ESM-2/ESM-3 (åºåˆ—ç¼–ç )
â”œâ”€â”€ TreeLSTM (ç‰©ç§æ ‘ç¼–ç )
â””â”€â”€ GNN (PPIç½‘ç»œç¼–ç )

è¿›åŒ–å±‚:
â”œâ”€â”€ ç¥–å…ˆé‡å»ºç½‘ç»œ
â”œâ”€â”€ ç¥ç»ODE (è¿ç»­æ—¶é—´è¿›åŒ–)
â””â”€â”€ å…±è¿›åŒ–Pottsæ¨¡å‹

å› æœå±‚:
â”œâ”€â”€ å› æœå›¾å­¦ä¹ 
â”œâ”€â”€ ç»“æ„å› æœæ¨¡å‹ (SCM)
â””â”€â”€ åäº‹å®æ¨ç†æ¨¡å—

é¢„æµ‹å±‚:
â”œâ”€â”€ PPIåˆ†ç±»å™¨
â”œâ”€â”€ å¹²é¢„æ•ˆåº”é¢„æµ‹å™¨
â””â”€â”€ ä¸ç¡®å®šæ€§é‡åŒ–
```

#### 4.1.2 æ ¸å¿ƒæ¨¡å—å®ç°

**ç¥ç»ODEç”¨äºè¿›åŒ–å»ºæ¨¡**ï¼š

```python
class NeuralEvolutionODE(nn.Module):
    """
    ç”¨ç¥ç»ODEå»ºæ¨¡è¿ç»­æ—¶é—´çš„åºåˆ—è¿›åŒ–
    """
    def __init__(self, hidden_dim):
        self.ode_func = nn.Sequential(
            nn.Linear(hidden_dim, hidden_dim * 2),
            nn.Tanh(),
            nn.Linear(hidden_dim * 2, hidden_dim)
        )
    
    def forward(self, seq_embedding, time_span):
        """
        seq_embedding: åºåˆ—çš„å‘é‡è¡¨ç¤º
        time_span: [t_start, t_end] è¿›åŒ–æ—¶é—´
        """
        from torchdiffeq import odeint
        
        # å®šä¹‰ODE: dh/dt = f(h, t)
        def ode_dynamics(t, h):
            return self.ode_func(h)
        
        # æ±‚è§£ODE
        trajectory = odeint(
            ode_dynamics, 
            seq_embedding, 
            time_span,
            method='dopri5'  # Runge-Kuttaæ–¹æ³•
        )
        
        return trajectory[-1]  # è¿”å›ç»ˆç‚¹çŠ¶æ€
```

**å˜åˆ†è‡ªç¼–ç å™¨ç”¨äºä¸ç¡®å®šæ€§**ï¼š

```python
class VariationalAncestralReconstructor(nn.Module):
    """
    ç”¨VAEå»ºæ¨¡ç¥–å…ˆåºåˆ—çš„ä¸ç¡®å®šæ€§
    """
    def __init__(self):
        self.encoder = ESM2Encoder()
        self.mu_head = nn.Linear(hidden_dim, latent_dim)
        self.logvar_head = nn.Linear(hidden_dim, latent_dim)
        self.decoder = SequenceDecoder()
    
    def encode(self, modern_sequences, tree):
        # ç¼–ç ç°ä»£åºåˆ—
        h = self.encoder(modern_sequences)
        h_tree = self.tree_context(tree)
        h_combined = h + h_tree
        
        # è¾“å‡ºæ½œå˜é‡çš„åˆ†å¸ƒ
        mu = self.mu_head(h_combined)
        logvar = self.logvar_head(h_combined)
        return mu, logvar
    
    def reparameterize(self, mu, logvar):
        std = torch.exp(0.5 * logvar)
        eps = torch.randn_like(std)
        return mu + eps * std
    
    def decode(self, z):
        return self.decoder(z)
    
    def forward(self, modern_sequences, tree):
        mu, logvar = self.encode(modern_sequences, tree)
        z = self.reparameterize(mu, logvar)
        ancestral_seq = self.decode(z)
        return ancestral_seq, mu, logvar
    
    def sample_ancestors(self, modern_sequences, tree, n_samples=100):
        """é‡‡æ ·å¤šä¸ªå¯èƒ½çš„ç¥–å…ˆåºåˆ—"""
        mu, logvar = self.encode(modern_sequences, tree)
        samples = []
        for _ in range(n_samples):
            z = self.reparameterize(mu, logvar)
            ancestral_seq = self.decode(z)
            samples.append(ancestral_seq)
        return samples
```

### 4.2 è®­ç»ƒç­–ç•¥

#### 4.2.1 å¤šä»»åŠ¡å­¦ä¹ 

è”åˆä¼˜åŒ–å¤šä¸ªç›®æ ‡ï¼š

$$
\mathcal{L}_{\text{total}} = \mathcal{L}_{\text{PPI}} + \lambda_1 \mathcal{L}_{\text{evo}} + \lambda_2 \mathcal{L}_{\text{causal}} + \lambda_3 \mathcal{L}_{\text{interv}}
$$

å…¶ä¸­ï¼š
- $\mathcal{L}_{\text{PPI}}$: ç°ä»£PPIé¢„æµ‹æŸå¤±ï¼ˆäº¤å‰ç†µï¼‰
- $\mathcal{L}_{\text{evo}}$: è¿›åŒ–è½¨è¿¹é‡å»ºæŸå¤±
- $\mathcal{L}_{\text{causal}}$: å› æœå›¾å­¦ä¹ æŸå¤±
- $\mathcal{L}_{\text{interv}}$: å¹²é¢„é¢„æµ‹æŸå¤±ï¼ˆå¦‚æœæœ‰å®éªŒæ•°æ®ï¼‰

**å…·ä½“å®ç°**ï¼š

```python
def compute_loss(self, batch):
    # 1. PPIé¢„æµ‹æŸå¤±ï¼ˆæ ‡å‡†äºŒåˆ†ç±»ï¼‰
    ppi_pred = self.model(batch.seq_A, batch.seq_B)
    loss_ppi = F.binary_cross_entropy(ppi_pred, batch.ppi_label)
    
    # 2. è¿›åŒ–ä¸€è‡´æ€§æŸå¤±
    # ç¥–å…ˆå’Œåä»£çš„PPIåº”è¯¥æ»¡è¶³è¿›åŒ–æ¨¡å‹
    ancestral_ppi = self.model.reconstruct_ancestral_ppi(batch.tree)
    loss_evo = self.evolution_consistency_loss(
        ancestral_ppi, batch.modern_ppi, batch.tree
    )
    
    # 3. å› æœä¸€è‡´æ€§æŸå¤±
    # å­¦åˆ°çš„å› æœå›¾åº”è¯¥èƒ½è§£é‡Šå¹²é¢„å®éªŒ
    if batch.has_intervention_data:
        pred_effect = self.model.predict_intervention(batch.intervention)
        true_effect = batch.intervention_effect
        loss_causal = F.mse_loss(pred_effect, true_effect)
    else:
        loss_causal = 0
    
    # 4. å…±è¿›åŒ–æŸå¤±
    # ç›¸äº’ä½œç”¨çš„è›‹ç™½è´¨åº”è¯¥æœ‰ååŒè¿›åŒ–ä¿¡å·
    loss_coevo = self.coevolution_loss(batch.seq_A, batch.seq_B, batch.ppi_label)
    
    # æ€»æŸå¤±
    loss = loss_ppi + 0.1 * loss_evo + 0.2 * loss_causal + 0.05 * loss_coevo
    
    return loss
```

#### 4.2.2 è¯¾ç¨‹å­¦ä¹  (Curriculum Learning)

**é€æ­¥å¢åŠ ä»»åŠ¡éš¾åº¦**ï¼š

```python
class CurriculumTrainer:
    def __init__(self):
        self.stage = 1
    
    def train_epoch(self, epoch):
        if epoch < 10:
            # é˜¶æ®µ1: åªå­¦ä¹ ç°ä»£PPIé¢„æµ‹ï¼ˆç®€å•ï¼‰
            self.train_ppi_only()
        elif epoch < 20:
            # é˜¶æ®µ2: åŠ å…¥è¿›åŒ–çº¦æŸï¼ˆä¸­ç­‰ï¼‰
            self.train_ppi_with_evolution()
        elif epoch < 30:
            # é˜¶æ®µ3: åŠ å…¥å› æœå­¦ä¹ ï¼ˆå›°éš¾ï¼‰
            self.train_full_model()
        else:
            # é˜¶æ®µ4: å¾®è°ƒå¹²é¢„é¢„æµ‹ï¼ˆæœ€éš¾ï¼‰
            self.train_with_interventions()
```

#### 4.2.3 å¯¹æ¯”å­¦ä¹ 

**å­¦ä¹ è¿›åŒ–ä¸Šç›¸ä¼¼çš„è›‹ç™½è´¨å¯¹**ï¼š

```python
class ContrastiveEvolutionLearning:
    def __init__(self):
        self.temperature = 0.07
    
    def contrastive_loss(self, protein_A, positives, negatives):
        """
        protein_A: æŸ¥è¯¢è›‹ç™½è´¨
        positives: è¿›åŒ–ä¸Šç›¸å…³çš„è›‹ç™½è´¨ï¼ˆåŒæºï¼‰
        negatives: è¿›åŒ–ä¸Šæ— å…³çš„è›‹ç™½è´¨
        """
        # ç¼–ç 
        z_A = self.encoder(protein_A)
        z_pos = [self.encoder(p) for p in positives]
        z_neg = [self.encoder(n) for n in negatives]
        
        # å¯¹æ¯”æŸå¤±ï¼ˆInfoNCEï¼‰
        logits_pos = [torch.dot(z_A, z_p) / self.temperature for z_p in z_pos]
        logits_neg = [torch.dot(z_A, z_n) / self.temperature for z_n in z_neg]
        
        logits = torch.cat([torch.stack(logits_pos), torch.stack(logits_neg)])
        labels = torch.zeros(len(logits))
        labels[:len(positives)] = 1
        
        loss = F.cross_entropy(logits, labels)
        return loss
```

### 4.3 å·¥ç¨‹ä¼˜åŒ–

#### 4.3.1 åˆ†å¸ƒå¼è®­ç»ƒ

```python
# ä½¿ç”¨PyTorch DDPè¿›è¡Œå¤šGPUè®­ç»ƒ
import torch.distributed as dist
from torch.nn.parallel import DistributedDataParallel as DDP

def setup_distributed():
    dist.init_process_group("nccl")
    local_rank = int(os.environ["LOCAL_RANK"])
    torch.cuda.set_device(local_rank)
    return local_rank

def train_distributed():
    local_rank = setup_distributed()
    model = EvolutionaryCausalPPIModel().to(local_rank)
    model = DDP(model, device_ids=[local_rank])
    
    # è®­ç»ƒå¾ªç¯...
```

#### 4.3.2 æ··åˆç²¾åº¦è®­ç»ƒ

```python
from torch.cuda.amp import autocast, GradScaler

scaler = GradScaler()

for batch in dataloader:
    with autocast():  # è‡ªåŠ¨æ··åˆç²¾åº¦
        loss = model.compute_loss(batch)
    
    scaler.scale(loss).backward()
    scaler.step(optimizer)
    scaler.update()
```

#### 4.3.3 æ¢¯åº¦ç´¯ç§¯ï¼ˆå¤„ç†å¤§batchï¼‰

```python
accumulation_steps = 4

for i, batch in enumerate(dataloader):
    loss = model.compute_loss(batch) / accumulation_steps
    loss.backward()
    
    if (i + 1) % accumulation_steps == 0:
        optimizer.step()
        optimizer.zero_grad()
```

---

## 5. æ•°æ®éœ€æ±‚

### 5.1 æ ¸å¿ƒæ•°æ®é›†

#### 5.1.1 PRINGåŸºå‡†æ•°æ® âœ… (å·²æœ‰)

- **Human**: è®­ç»ƒé›†ï¼ˆ~100K PPIå¯¹ï¼‰
- **è·¨ç‰©ç§æµ‹è¯•**: Arath, Yeast, Ecoli
- **ä¼˜åŠ¿**: æ ‡å‡†åŒ–ã€é«˜è´¨é‡ã€å¯å¯¹æ¯”

#### 5.1.2 æ‰©å±•å¤šç‰©ç§æ•°æ® âœ… (ä½¿ç”¨STRING v12.0å…¨é›†)

**æ•°æ®æ¥æº**: STRING v12.0æ•°æ®åº“ï¼ˆæœåŠ¡å™¨å·²æœ‰å®Œæ•´æ•°æ®ï¼‰

**ç›®æ ‡ç‰©ç§**: è‡³å°‘**10-15ä¸ªç‰©ç§**ï¼Œè¦†ç›–ä¸»è¦è¿›åŒ–è°±ç³»

| è°±ç³» | ç‰©ç§ | NCBI Taxon ID | è¿›åŒ–è·ç¦» | é¢„æœŸPPIæ•° |
|-----|------|---------------|---------|----------|
| **çµé•¿ç±»** | Human (æ™ºäºº) | 9606 | åŸºå‡† | ~200,000 |
| | Chimpanzee (é»‘çŒ©çŒ©) | 9598 | 6 Mya | ~150,000 |
| | Macaque (çŒ•çŒ´) | 9544 | 25 Mya | ~100,000 |
| **å“ºä¹³ç±»** | Mouse (å°é¼ ) | 10090 | 90 Mya | ~180,000 |
| | Rat (å¤§é¼ ) | 10116 | 90 Mya | ~120,000 |
| | Dog (ç‹—) | 9615 | 95 Mya | ~80,000 |
| | Cow (ç‰›) | 9913 | 95 Mya | ~60,000 |
| **è„Šæ¤åŠ¨ç‰©** | Zebrafish (æ–‘é©¬é±¼) | 7955 | 450 Mya | ~100,000 |
| | Chicken (é¸¡) | 9031 | 300 Mya | ~70,000 |
| **æ¤ç‰©** | A.thaliana (æ‹Ÿå—èŠ¥) | 3702 | 1,500 Mya | ~150,000 |
| | Rice (æ°´ç¨») | 4530 | 1,500 Mya | ~80,000 |
| **çœŸèŒ** | S.cerevisiae (é…µæ¯) | 4932 | 1,000 Mya | ~200,000 |
| | S.pombe (è£‚æ®–é…µæ¯) | 4896 | 1,000 Mya | ~60,000 |
| **ç»†èŒ** | E.coli (å¤§è‚ æ†èŒ) | 511145 | 3,000 Mya | ~100,000 |
| | B.subtilis (æ¯è‰èŠ½å­¢æ†èŒ) | 224308 | 3,000 Mya | ~50,000 |

**ç‰©ç§æ ‘ï¼ˆç®€åŒ–ï¼‰**:
```
                         â”Œâ”€ Human
                    â”Œâ”€â”€â”€â”€â”¤ Chimp (6 Mya)
               â”Œâ”€â”€â”€â”€â”¤    â””â”€ Macaque (25 Mya)
          â”Œâ”€â”€â”€â”€â”¤    â”‚
          â”‚    â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€ Mouse, Rat (90 Mya)
          â”‚    â”‚
    â”€â”€â”€â”€â”€â”€â”¤    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Zebrafish (450 Mya)
          â”‚
          â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ Arath, Rice (1,500 Mya)
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
                    â”‚    â”Œâ”€â”€â”€â”€â”€ Yeast, S.pombe (1,000 Mya)
                    â””â”€â”€â”€â”€â”¤
                         â””â”€â”€â”€â”€â”€ E.coli, B.subtilis (3,000 Mya)
```

---

### ğŸ¯ STRINGæ•°æ®è¿‡æ»¤ç­–ç•¥ï¼ˆé‡è¦ï¼‰

#### ç­–ç•¥1: Combined Scoreé˜ˆå€¼é€‰æ‹©

**STRINGè¯„åˆ†ç³»ç»Ÿ**ï¼š
- **èŒƒå›´**: 0-1000ï¼ˆç»¼åˆ7ä¸ªè¯æ®é€šé“ï¼‰
- **7ä¸ªé€šé“**: Neighborhood, Fusion, Co-occurrence, Co-expression, **Experimental**, **Database**, Text mining

**è¯„åˆ†è´¨é‡å¯¹ç…§è¡¨**ï¼š

| Scoreé˜ˆå€¼ | ç½®ä¿¡åº¦ç­‰çº§ | é¢„æœŸå‡é˜³æ€§ç‡ | æ•°æ®é‡ (Human) | æ¨èç”¨é€” |
|----------|-----------|------------|---------------|---------|
| 900-1000 | æœ€é«˜ | ~10% | ~50,000 | æ ¸å¿ƒè®­ç»ƒé›† |
| **700-900** | **é«˜** | **~20%** | **~200,000** | **âœ… æ ‡å‡†è®­ç»ƒé›†ï¼ˆæ¨èï¼‰** |
| 400-700 | ä¸­ | ~40% | ~500,000 | æ‰©å±•/è¿›åŒ–åˆ†æ |
| 150-400 | ä½ | ~60% | ~1,000,000 | âš ï¸ ä¸æ¨è |

**æ¨èé˜ˆå€¼**: **Combined Score >= 700**

**ç†ç”±**ï¼š
1. âœ… **å¹³è¡¡è´¨é‡ä¸æ•°é‡**: ~20%å‡é˜³æ€§ç‡å¯æ¥å—ï¼Œæ•°æ®é‡å……è¶³
2. âœ… **è¦†ç›–å¤šç§è¯æ®**: åŒ…å«å®éªŒã€æ•°æ®åº“ã€å…±è¡¨è¾¾ç­‰å¤šç§è¯æ®
3. âœ… **æ”¯æŒç»Ÿè®¡æ¨æ–­**: æ•°æ®é‡è¶³å¤Ÿè®­ç»ƒæ·±åº¦å­¦ä¹ æ¨¡å‹
4. âœ… **åŒ…å«è¿›åŒ–ä¿¡å·**: å…±ç°ã€å…±è¡¨è¾¾åŒ…å«é‡è¦çš„è¿›åŒ–ç›¸å…³ä¿¡æ¯

#### ç­–ç•¥2: æ˜¯å¦ä½¿ç”¨"ç‰©ç†å­ç½‘"ï¼Ÿ

**ç‰©ç†å­ç½‘å®šä¹‰**: ä»…åŒ…å«æœ‰ç›´æ¥ç‰©ç†æ¥è§¦è¯æ®çš„PPIï¼ˆExperimental + Databaseé€šé“æœ‰å€¼ï¼‰

**å¯¹æ¯”åˆ†æ**ï¼š

| æŒ‡æ ‡ | ç‰©ç†å­ç½‘ | Combined Score >= 700 |
|-----|---------|---------------------|
| **æ•°æ®é‡** (Human) | ~30,000 | ~200,000 |
| **å‡é˜³æ€§ç‡** | ~15% | ~20% |
| **è´¨é‡æå‡** | +5% | åŸºå‡† |
| **è¿›åŒ–ä¿¡å·** | âŒ å¼±ï¼ˆä¸¢å¤±å…±è¡¨è¾¾ã€å…±ç°ï¼‰ | âœ… å¼ºï¼ˆåŒ…å«å¤šç§è¯æ®ï¼‰ |
| **åå‘æ€§** | âŒ ä¸¥é‡ï¼ˆç ”ç©¶çƒ­ç‚¹è¿‡åº¦ä»£è¡¨ï¼‰ | âœ… è¾ƒå° |
| **æ¨èåº¦** | âš ï¸ ä¸æ¨è | âœ… æ¨è |

**ç»“è®º**: âŒ **ä¸ä½¿ç”¨ç‰©ç†å­ç½‘ï¼Œä½¿ç”¨å®Œæ•´çš„Combined Scoreè¿‡æ»¤**

**åŸå› **ï¼š
1. ç‰©ç†å­ç½‘æ•°æ®é‡å¤ªå°‘ï¼ˆä»…15%ï¼‰ï¼Œæ— æ³•æ”¯æŒæ·±åº¦å­¦ä¹ 
2. è´¨é‡æå‡æœ‰é™ï¼ˆä»…5%ï¼‰ï¼Œä½†æŸå¤±85%æ•°æ®
3. ä¸¢å¤±äº†å…±è¡¨è¾¾ã€å…±ç°ç­‰é‡è¦çš„è¿›åŒ–ä¿¡å·
4. è¿‡åº¦ä»£è¡¨ç ”ç©¶çƒ­ç‚¹è›‹ç™½ï¼Œæ³›åŒ–èƒ½åŠ›å·®

#### ç­–ç•¥3: åˆ†å±‚è®­ç»ƒç­–ç•¥ï¼ˆæ¨èï¼‰

**ä¸‰å±‚æ•°æ®åˆ’åˆ†**ï¼š

```python
class StratifiedStringDataset:
    """åˆ†å±‚STRINGæ•°æ®é›†"""
    
    def __init__(self):
        # ä¸‰ä¸ªç½®ä¿¡åº¦å±‚
        self.tiers = {
            'tier1_core': {
                'threshold': 900,
                'weight': 1.0,
                'purpose': 'æ ¸å¿ƒè®­ç»ƒé›†ï¼ˆé«˜è´¨é‡ï¼‰'
            },
            'tier2_standard': {
                'threshold': 700,
                'weight': 1.0,
                'purpose': 'æ ‡å‡†è®­ç»ƒé›†ï¼ˆå¹³è¡¡ï¼‰'
            },
            'tier3_extended': {
                'threshold': 400,
                'weight': 0.5,
                'purpose': 'æ‰©å±•é›†ï¼ˆè¿›åŒ–åˆ†æï¼‰'
            }
        }
    
    def load_ppi_data(self, species, taxon_id):
        """
        ä»STRINGåŠ è½½PPIæ•°æ®
        
        å‚æ•°:
            species: ç‰©ç§åç§°
            taxon_id: NCBI Taxon ID
        
        è¿”å›:
            åˆ†å±‚çš„PPIæ•°æ®
        """
        
        # ä»STRINGå…¨é›†ä¸­æå–è¯¥ç‰©ç§çš„æ•°æ®
        all_ppis = self.load_from_string_db(taxon_id)
        
        # æŒ‰ç½®ä¿¡åº¦åˆ†å±‚
        tier1 = all_ppis[all_ppis['combined_score'] >= 900]
        tier2 = all_ppis[all_ppis['combined_score'] >= 700]
        tier3 = all_ppis[all_ppis['combined_score'] >= 400]
        
        return {
            'tier1': tier1,  # æ ¸å¿ƒé›†
            'tier2': tier2,  # æ ‡å‡†é›†ï¼ˆåŒ…å«tier1ï¼‰
            'tier3': tier3   # æ‰©å±•é›†ï¼ˆåŒ…å«tier1+tier2ï¼‰
        }
    
    def compute_loss(self, predictions, labels, tier):
        """
        æ ¹æ®æ•°æ®å±‚è°ƒæ•´æŸå¤±æƒé‡
        """
        weight = self.tiers[tier]['weight']
        loss = F.binary_cross_entropy(predictions, labels)
        return weight * loss
```

**è®­ç»ƒæµç¨‹**ï¼š
```python
# è®­ç»ƒå¾ªç¯
for epoch in range(num_epochs):
    # 1. æ ¸å¿ƒé›† + æ ‡å‡†é›†ï¼ˆæƒé‡1.0ï¼‰
    loss1 = train_on_data(tier1_data, weight=1.0)
    loss2 = train_on_data(tier2_data, weight=1.0)
    
    # 2. æ‰©å±•é›†ï¼ˆæƒé‡0.5ï¼Œç”¨äºæ•æ‰å¼±ä¿¡å·ï¼‰
    loss3 = train_on_data(tier3_data, weight=0.5)
    
    # 3. æ€»æŸå¤±
    total_loss = loss1 + loss2 + loss3
```

---

### ğŸ“¦ æ•°æ®æ”¶é›†è„šæœ¬

```python
class MultiSpeciesStringCollector:
    """å¤šç‰©ç§STRINGæ•°æ®æ”¶é›†å™¨"""
    
    def __init__(self, string_data_path):
        """
        å‚æ•°:
            string_data_path: STRINGæ•°æ®åº“è·¯å¾„ï¼ˆæœåŠ¡å™¨ä¸Šçš„å®Œæ•´æ•°æ®ï¼‰
        """
        self.string_data_path = string_data_path
        self.confidence_threshold = 700  # æ ‡å‡†é˜ˆå€¼
        
        # ç›®æ ‡ç‰©ç§åˆ—è¡¨
        self.target_species = {
            'human': 9606,
            'chimpanzee': 9598,
            'macaque': 9544,
            'mouse': 10090,
            'rat': 10116,
            'dog': 9615,
            'zebrafish': 7955,
            'chicken': 9031,
            'arath': 3702,
            'rice': 4530,
            'yeast': 4932,
            's_pombe': 4896,
            'ecoli': 511145,
            'b_subtilis': 224308
        }
    
    def collect_all_species(self):
        """æ”¶é›†æ‰€æœ‰ç‰©ç§çš„PPIæ•°æ®"""
        
        all_data = {}
        
        for species_name, taxon_id in self.target_species.items():
            print(f"Processing {species_name} (taxon: {taxon_id})...")
            
            # 1. ä»STRINGæå–PPIç½‘ç»œ
            ppis = self.extract_ppis(taxon_id)
            
            # 2. æå–åºåˆ—
            sequences = self.extract_sequences(taxon_id)
            
            # 3. ç»Ÿè®¡ä¿¡æ¯
            stats = self.compute_statistics(ppis, sequences)
            
            all_data[species_name] = {
                'taxon_id': taxon_id,
                'ppis': ppis,
                'sequences': sequences,
                'stats': stats
            }
            
            print(f"  âœ“ {species_name}: {len(ppis):,} PPIs, "
                  f"{len(sequences):,} proteins")
        
        return all_data
    
    def extract_ppis(self, taxon_id, min_score=700):
        """
        ä»STRINGæå–PPIæ•°æ®
        
        å‚æ•°:
            taxon_id: NCBI Taxon ID
            min_score: æœ€å°ç½®ä¿¡åº¦åˆ†æ•°
        
        è¿”å›:
            DataFrame with columns: protein1, protein2, combined_score, 
                                   neighborhood, fusion, cooccurence, 
                                   coexpression, experimental, database, textmining
        """
        
        # è¯»å–STRING protein.links.detailed.v12.0.txt
        # æ ¼å¼: protein1 protein2 neighborhood fusion ... combined_score
        
        ppis = []
        
        links_file = f"{self.string_data_path}/{taxon_id}.protein.links.detailed.v12.0.txt"
        
        with open(links_file) as f:
            header = f.readline()  # è·³è¿‡è¡¨å¤´
            
            for line in f:
                fields = line.strip().split()
                combined_score = int(fields[-1])
                
                # è¿‡æ»¤ä½ç½®ä¿¡åº¦
                if combined_score >= min_score:
                    ppis.append({
                        'protein1': fields[0],
                        'protein2': fields[1],
                        'neighborhood': int(fields[2]),
                        'fusion': int(fields[3]),
                        'cooccurence': int(fields[4]),
                        'coexpression': int(fields[5]),
                        'experimental': int(fields[6]),
                        'database': int(fields[7]),
                        'textmining': int(fields[8]),
                        'combined_score': combined_score
                    })
        
        return pd.DataFrame(ppis)
    
    def extract_sequences(self, taxon_id):
        """æå–è›‹ç™½è´¨åºåˆ—"""
        
        sequences = {}
        
        seq_file = f"{self.string_data_path}/{taxon_id}.protein.sequences.v12.0.fa"
        
        from Bio import SeqIO
        for record in SeqIO.parse(seq_file, 'fasta'):
            sequences[record.id] = str(record.seq)
        
        return sequences
    
    def compute_statistics(self, ppis, sequences):
        """è®¡ç®—ç»Ÿè®¡ä¿¡æ¯"""
        
        return {
            'num_ppis': len(ppis),
            'num_proteins': len(sequences),
            'avg_combined_score': ppis['combined_score'].mean(),
            'has_experimental': (ppis['experimental'] > 0).sum(),
            'has_database': (ppis['database'] > 0).sum(),
            'physical_subset': ((ppis['experimental'] > 0) | 
                               (ppis['database'] > 0)).sum()
        }
```

---

### ğŸ“Š é¢„æœŸæ•°æ®è§„æ¨¡

| ç‰©ç§ | Proteins | PPIs (Score>=700) | PPIs (Score>=900) | ç‰©ç†å­ç½‘ |
|------|----------|-------------------|-------------------|---------|
| Human | ~20,000 | ~200,000 | ~50,000 | ~30,000 |
| Mouse | ~22,000 | ~180,000 | ~45,000 | ~28,000 |
| Yeast | ~6,000 | ~200,000 | ~80,000 | ~60,000 |
| Arath | ~27,000 | ~150,000 | ~40,000 | ~25,000 |
| Ecoli | ~4,400 | ~100,000 | ~30,000 | ~20,000 |
| **æ€»è®¡** | **~100,000** | **~1,500,000** | **~400,000** | **~250,000** |

**å­˜å‚¨éœ€æ±‚**: çº¦50-100GBï¼ˆå‹ç¼©åï¼‰

#### 5.1.3 å¹²é¢„å®éªŒæ•°æ® ğŸ†• (éœ€è¦æ•´åˆ)

**1. ç‚¹çªå˜æ•°æ®**

| æ•°æ®åº“ | è§„æ¨¡ | å†…å®¹ | ç”¨é€” |
|--------|------|------|------|
| [DeepMutationalScan](https://github.com/OATML-Markslab/DeepSequence) | ~50ä¸ªè›‹ç™½è´¨å®¶æ— | æ·±åº¦çªå˜æ‰«ææ•°æ® | éªŒè¯çªå˜æ•ˆåº”é¢„æµ‹ |
| [ProTherm](https://web.iitm.ac.in/bioinfo2/prothermdb/) | ~25,000ä¸ªçªå˜ | çƒ­ç¨³å®šæ€§å˜åŒ– | ç¨³å®šæ€§è·¯å¾„å› æœæ•ˆåº” |
| [SKEMPI 2.0](https://life.bsc.es/pid/skempi2) | ~7,000ä¸ªçªå˜ | ç»“åˆäº²å’ŒåŠ›å˜åŒ– (Î”Î”G) | **ç›´æ¥éªŒè¯PPIæ•ˆåº”** â­ |

**SKEMPIç¤ºä¾‹æ•°æ®**ï¼š
```
Protein1  Protein2  Mutation  Î”Î”G(kcal/mol)  Effect
1A22_A    1A22_B    A_T10A    +2.3           Weaken
1BRS_A    1BRS_B    A_Y35F    -0.5           Slightly strengthen
```

**æ•´åˆè„šæœ¬**ï¼š
```python
class InterventionDataIntegrator:
    def load_skempi(self):
        # åŠ è½½SKEMPIæ•°æ®
        skempi = pd.read_csv("SKEMPI_v2.csv")
        
        # è½¬æ¢ä¸ºå› æœå¹²é¢„æ ¼å¼
        interventions = []
        for _, row in skempi.iterrows():
            interventions.append({
                'protein_A': row['Protein1'],
                'protein_B': row['Protein2'],
                'intervention': {
                    'type': 'mutation',
                    'position': row['Position'],
                    'from_aa': row['Wild_type'],
                    'to_aa': row['Mutant']
                },
                'effect': {
                    'delta_binding_affinity': row['ddG'],
                    'ppi_change': 1 if row['ddG'] < -0.5 else (-1 if row['ddG'] > 0.5 else 0)
                }
            })
        
        return interventions
```

**2. CRISPRç­›é€‰æ•°æ®**

| æ•°æ®åº“ | è§„æ¨¡ | å†…å®¹ | ç”¨é€” |
|--------|------|------|------|
| [DepMap](https://depmap.org/) | ~1000ä¸ªç»†èƒç³» | åŸºå› æ•²é™¤å¯¹ç»†èƒæ´»åŠ›çš„å½±å“ | ç½‘ç»œçº§å¹²é¢„æ•ˆåº” |
| [CORUM](https://mips.helmholtz-muenchen.de/corum/) | ~5000ä¸ªå¤åˆç‰© | è›‹ç™½è´¨å¤åˆç‰©ç»„æˆ | éªŒè¯å¤šè›‹ç™½PPIé¢„æµ‹ |

**3. è¯ç‰©æ‰°åŠ¨æ•°æ®**

| æ•°æ®åº“ | è§„æ¨¡ | å†…å®¹ | ç”¨é€” |
|--------|------|------|------|
| [LINCS L1000](https://lincsproject.org/) | ~100ä¸‡ä¸ªåŸºå› è¡¨è¾¾è°± | å°åˆ†å­åŒ–åˆç‰©æ‰°åŠ¨ | é—´æ¥å¹²é¢„æ•ˆåº” |
| [STITCH](http://stitch.embl.de/) | ~50ä¸‡ä¸ªè›‹ç™½-åŒ–åˆç‰©ç›¸äº’ä½œç”¨ | è¯ç‰©é¶ç‚¹ | è¯ç‰©å¹²é¢„å»ºæ¨¡ |

### 5.2 è¾…åŠ©æ•°æ®

#### 5.2.1 ç»“æ„æ•°æ®

- **AlphaFold Database**: ~200M ç»“æ„é¢„æµ‹ï¼ˆç”¨äºç•Œé¢åˆ†æï¼‰
- **PDB**: ~20ä¸‡å®éªŒç»“æ„ï¼ˆé«˜è´¨é‡ç•Œé¢ï¼‰
- **PDBbind**: ~20,000ä¸ªè›‹ç™½-é…ä½“å¤åˆç‰©ï¼ˆç»“åˆäº²å’ŒåŠ›ï¼‰

#### 5.2.2 åŠŸèƒ½æ³¨é‡Š

- **GO (Gene Ontology)**: åŠŸèƒ½åˆ†ç±»
- **InterPro/Pfam**: è›‹ç™½è´¨å®¶æ—å’Œç»“æ„åŸŸ
- **KEGG Pathway**: é€šè·¯ä¿¡æ¯

#### 5.2.3 è¿›åŒ–ä¿¡æ¯

- **TimeTree**: ç‰©ç§åˆ†åŒ–æ—¶é—´
- **OrthoDB**: ç›´ç³»åŒæºå…³ç³»
- **Pfam**: å®¶æ—è¿›åŒ–æ ‘

### 5.3 æ•°æ®é¢„å¤„ç†æµç¨‹

```python
class DataPreprocessingPipeline:
    def __init__(self):
        self.species_tree = self.build_species_tree()
    
    def build_species_tree(self):
        """æ„å»ºç‰©ç§æ ‘ï¼ˆä»TimeTreeæ•°æ®åº“ï¼‰"""
        from ete3 import Tree
        
        # ä¸‹è½½ç‰©ç§æ ‘
        tree = Tree("((human:6,mouse:6):90,zebrafish:96,((arath:150):50,yeast:200):50,ecoli:300);", format=1)
        
        # æ ‡æ³¨åˆ†æ”¯é•¿åº¦ï¼ˆç™¾ä¸‡å¹´ï¼‰
        return tree
    
    def align_orthologs(self, species_A, species_B):
        """å¯¹é½ä¸¤ä¸ªç‰©ç§çš„ç›´ç³»åŒæºè›‹ç™½"""
        orthologs = []
        
        # ä»OrthoDBæŸ¥è¯¢
        orthodb = OrthoDBQuery()
        for protein_A in self.get_proteins(species_A):
            protein_B = orthodb.find_ortholog(protein_A, species_B)
            if protein_B:
                orthologs.append((protein_A, protein_B))
        
        return orthologs
    
    def construct_training_pairs(self):
        """æ„å»ºè®­ç»ƒæ•°æ®ï¼š(seq_A, seq_B, PPI, evolutionary_context)"""
        training_data = []
        
        for species in self.species_list:
            ppi_network = self.load_ppi(species)
            
            for edge in ppi_network.edges():
                protein_A, protein_B = edge
                
                # æŸ¥æ‰¾ç›´ç³»åŒæº
                orthologs_A = self.find_orthologs_across_species(protein_A)
                orthologs_B = self.find_orthologs_across_species(protein_B)
                
                # æ„å»ºè¿›åŒ–ä¸Šä¸‹æ–‡
                evo_context = {
                    'species': species,
                    'orthologs_A': orthologs_A,
                    'orthologs_B': orthologs_B,
                    'conservation_score': self.compute_conservation(orthologs_A, orthologs_B),
                    'species_tree_path': self.species_tree.get_path(species, 'human')
                }
                
                training_data.append({
                    'seq_A': self.get_sequence(protein_A),
                    'seq_B': self.get_sequence(protein_B),
                    'ppi': 1,
                    'evo_context': evo_context
                })
        
        return training_data
```

---

## 6. å®éªŒè®¾è®¡

### 6.1 è¯„ä¼°ä»»åŠ¡

#### 6.1.1 ä»»åŠ¡1: æ ‡å‡†PPIé¢„æµ‹ï¼ˆåŸºçº¿å¯¹æ¯”ï¼‰

**ç›®æ ‡**: è¯æ˜æ–¹æ³•åœ¨ä¼ ç»Ÿä»»åŠ¡ä¸Šä¸è¾“äºç°æœ‰æ–¹æ³•

**è®¾ç½®**:
- æ•°æ®é›†: PRING benchmark (human train/val/test)
- åŸºçº¿æ–¹æ³•: 
  - DeepPPI (PSSM-based)
  - PIPR (sequence-only)
  - GNN-PPI (graph-based)
  - ESM-based baseline
- è¯„ä¼°æŒ‡æ ‡: AUPR, AUROC, F1, Precision@K

**é¢„æœŸç»“æœ**: 
- è‡³å°‘ä¸æœ€ä½³åŸºçº¿æŒå¹³
- åœ¨é•¿å°¾å®¶æ—ä¸Šæ˜¾è‘—æå‡ï¼ˆå› ä¸ºè€ƒè™‘äº†è¿›åŒ–ï¼‰

#### 6.1.2 ä»»åŠ¡2: è·¨ç‰©ç§æ³›åŒ– â­ (æ ¸å¿ƒä¼˜åŠ¿)

**ç›®æ ‡**: è¯æ˜è¿›åŒ–å»ºæ¨¡å¸¦æ¥çš„æ³›åŒ–èƒ½åŠ›

**è®¾ç½®**:
```
è®­ç»ƒ: Human PPIç½‘ç»œ
æµ‹è¯•: Arath, Yeast, Ecoli (é›¶æ ·æœ¬)
```

**å¯¹æ¯”å®éªŒ**:
- æ— è¿›åŒ–ä¿¡æ¯: ç›´æ¥é¢„æµ‹
- æœ‰è¿›åŒ–ä¿¡æ¯: åˆ©ç”¨è¿›åŒ–è½¨è¿¹å¤–æ¨

**è¯„ä¼°æŒ‡æ ‡**:
- æ ‡å‡†æŒ‡æ ‡: AUPR, AUROC
- **è¿›åŒ–ä¸€è‡´æ€§**: é¢„æµ‹çš„PPIæ˜¯å¦ç¬¦åˆè¿›åŒ–çº¦æŸï¼Ÿ
- **ç³»ç»Ÿå‘è‚²ä¿¡å·**: é¢„æµ‹å‡†ç¡®ç‡ vs è¿›åŒ–è·ç¦»çš„å…³ç³»

**é¢„æœŸç»“æœ**:
- ä¼ ç»Ÿæ–¹æ³•åœ¨è¿œç¼˜ç‰©ç§ä¸Šå´©æºƒ
- æˆ‘ä»¬çš„æ–¹æ³•æ€§èƒ½å¹³ç¨³ä¸‹é™ï¼ˆå› ä¸ºæ˜¾å¼å»ºæ¨¡è¿›åŒ–ï¼‰

**å…³é”®å›¾è¡¨**:
```
æ€§èƒ½ (AUPR)
  â”‚
  â”‚    â—â”€â”€â”€â”€â—â”€â”€â”€â”€â—  ä¼ ç»Ÿæ–¹æ³•ï¼ˆçªç„¶å´©æºƒï¼‰
  â”‚              â•²
  â”‚               â•²
  â”‚    â—â”€â”€â”€â”€â—â”€â”€â”€â”€â—â”€â—â”€â—  æˆ‘ä»¬çš„æ–¹æ³•ï¼ˆå¹³ç¨³ä¸‹é™ï¼‰
  â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ è¿›åŒ–è·ç¦»
  0   çµé•¿  å“ºä¹³  è„Šæ¤  çœŸèŒ  ç»†èŒ
```

#### 6.1.3 ä»»åŠ¡3: çªå˜æ•ˆåº”é¢„æµ‹ â­â­ (æ ¸å¿ƒåˆ›æ–°)

**ç›®æ ‡**: è¯æ˜å› æœå»ºæ¨¡èƒ½é¢„æµ‹å¹²é¢„æ•ˆåº”

**è®¾ç½®**:
- æµ‹è¯•é›†: SKEMPI 2.0ï¼ˆ7000+ä¸ªçªå˜ï¼Œå·²çŸ¥Î”Î”Gï¼‰
- ä»»åŠ¡: ç»™å®šé‡ç”Ÿå‹PPIå’Œçªå˜ï¼Œé¢„æµ‹ç»“åˆäº²å’ŒåŠ›å˜åŒ–

**å¯¹æ¯”æ–¹æ³•**:
- çº¯åºåˆ—æ–¹æ³•: ESM-1v (zero-shot mutation effect)
- ç»“æ„æ–¹æ³•: FoldX, Rosetta
- **æˆ‘ä»¬çš„æ–¹æ³•**: å› æœå¹²é¢„é¢„æµ‹

**è¯„ä¼°æŒ‡æ ‡**:
- Spearmanç›¸å…³ç³»æ•° (é¢„æµ‹Î”Î”G vs å®éªŒÎ”Î”G)
- åˆ†ç±»å‡†ç¡®ç‡ (strengthen/weaken/neutral)

**é¢„æœŸç»“æœ**:
- è¶…è¶Šçº¯åºåˆ—æ–¹æ³•ï¼ˆå› ä¸ºè€ƒè™‘äº†ç»“æ„å’Œè¿›åŒ–ï¼‰
- æ¥è¿‘æˆ–è¶…è¶ŠåŸºäºç‰©ç†çš„æ–¹æ³•ï¼ˆFoldXï¼‰
- **å…³é”®ä¼˜åŠ¿**: å¯ä»¥ç»™å‡ºå› æœè§£é‡Šï¼

**æ¡ˆä¾‹ç ”ç©¶**:
```
çªå˜: Barnase (A) - Barstar (B), A_R83A

é¢„æµ‹:
  Î”Î”G = +3.2 kcal/mol (å®éªŒå€¼: +3.5)
  
å› æœè§£é‡Š:
  - ç›´æ¥æ•ˆåº” (60%): R83ç›æ¡¥æ–­è£‚ â†’ ç•Œé¢äº²å’ŒåŠ›ä¸‹é™
  - é—´æ¥æ•ˆåº” (30%): å±€éƒ¨ç»“æ„æ¾å¼› â†’ è¿›ä¸€æ­¥å‰Šå¼±ç•Œé¢
  - è¿›åŒ–è¯æ® (10%): R83åœ¨æ‰€æœ‰è„Šæ¤åŠ¨ç‰©ä¸­ä¿å®ˆ â†’ åŠŸèƒ½å…³é”®
  
ç½®ä¿¡åº¦: é«˜ï¼ˆå› ä¸ºç±»ä¼¼çªå˜åœ¨è¿›åŒ–ä¸­è¢«æ¸…é™¤ï¼‰
```

#### 6.1.4 ä»»åŠ¡4: åäº‹å®æ¨ç† â­â­â­ (æœ€é«˜åˆ›æ–°)

**ç›®æ ‡**: å›ç­”"what if"é—®é¢˜ï¼ˆç°æœ‰æ–¹æ³•æ— æ³•åšåˆ°ï¼‰

**ç¤ºä¾‹é—®é¢˜**:
1. "å¦‚æœHIVè›‹ç™½è¿›åŒ–åˆ°ä¸äººç±»è›‹ç™½æœ‰æ›´å¼ºPPIï¼Œä¼šæ€æ ·ï¼Ÿ"
2. "å¦‚æœå»é™¤æŸä¸ªé€‰æ‹©å‹åŠ›ï¼Œå“ªäº›PPIä¼šæ¶ˆå¤±ï¼Ÿ"
3. "è®¾è®¡ä¸€ä¸ªçªå˜ç»„åˆï¼Œä½¿å¾—PPIå¼ºåº¦å¢åŠ 2å€ï¼Ÿ"

**å®éªŒè®¾ç½®**:

**å®éªŒ4.1: è¿›åŒ–åäº‹å®**
```
é—®é¢˜: å¦‚æœçµé•¿ç±»æ²¡æœ‰ç‰¹å®šçš„é€‰æ‹©å‹åŠ›ï¼ˆå¦‚ç—…æ¯’é˜²å¾¡ï¼‰ï¼Œ
     æŸäº›PPIæ˜¯å¦ä¼šæ¶ˆå¤±ï¼Ÿ

æ–¹æ³•:
1. è¯†åˆ«åœ¨çµé•¿ç±»ä¸­å¿«é€Ÿè¿›åŒ–çš„PPI
2. åäº‹å®ï¼šç§»é™¤æ­£é€‰æ‹©å‹åŠ›
3. é¢„æµ‹PPIçš„"ä¸­æ€§è¿›åŒ–"è½¨è¿¹

éªŒè¯: æ¯”è¾ƒä¸éçµé•¿ç±»å“ºä¹³åŠ¨ç‰©çš„PPIï¼ˆå®ƒä»¬ç¼ºå°‘è¿™ä¸ªå‹åŠ›ï¼‰
```

**å®éªŒ4.2: æ²»ç–—åäº‹å®**
```
é—®é¢˜: å¯¹äºè‡´ç—…çªå˜å¯¼è‡´çš„PPIç ´åï¼Œ
     å“ªäº›äºŒæ¬¡çªå˜å¯ä»¥æ¢å¤PPIï¼Ÿ

æ–¹æ³•:
1. è¾“å…¥ï¼šè‡´ç—…çªå˜ + PPIç ´å
2. åäº‹å®æœç´¢ï¼šæ‰¾åˆ°æ¢å¤PPIçš„çªå˜ç»„åˆ
3. æ’åºï¼šæŒ‰è¿›åŒ–å¯è¡Œæ€§å’Œæ•ˆæœ

åº”ç”¨: ç²¾å‡†åŒ»ç–—ã€è›‹ç™½è´¨å·¥ç¨‹
```

### 6.2 æ¶ˆèå®éªŒ

**ç›®æ ‡**: éªŒè¯æ¯ä¸ªæ¨¡å—çš„è´¡çŒ®

| æ¨¡å‹å˜ä½“ | è¿›åŒ–æ¨¡å— | å› æœæ¨¡å— | å…±è¿›åŒ– | é¢„æœŸæ€§èƒ½ |
|---------|---------|---------|--------|---------|
| Baseline | âœ— | âœ— | âœ— | åŸºçº¿ |
| +Evolution | âœ“ | âœ— | âœ— | +5% AUPRï¼ˆè·¨ç‰©ç§ï¼‰ |
| +Causal | âœ— | âœ“ | âœ— | +10% çªå˜é¢„æµ‹ |
| +Coevolution | âœ— | âœ— | âœ“ | +3% AUPR |
| **Full Model** | âœ“ | âœ“ | âœ“ | **æœ€ä¼˜** |

**å…³é”®æ¶ˆè**:
1. **è¿›åŒ–æ·±åº¦**: æ¯”è¾ƒä½¿ç”¨5ä¸ª vs 10ä¸ª vs 20ä¸ªç‰©ç§
2. **å› æœå›¾ç»“æ„**: æ¯”è¾ƒæ‰‹å·¥è®¾è®¡ vs è‡ªåŠ¨å­¦ä¹ çš„å› æœå›¾
3. **ä¸ç¡®å®šæ€§**: æ¯”è¾ƒç‚¹ä¼°è®¡ vs åˆ†å¸ƒä¼°è®¡ï¼ˆVAEï¼‰

### 6.3 å¯è§£é‡Šæ€§åˆ†æ

#### 6.3.1 è¿›åŒ–çº¦æŸå¯è§†åŒ–

**ç»˜åˆ¶PPIçš„è¿›åŒ–è½¨è¿¹**:
```python
def plot_ppi_evolution_trajectory(protein_A, protein_B):
    # æ²¿ç‰©ç§æ ‘é‡å»ºPPIå¼ºåº¦
    trajectory = model.reconstruct_ppi_trajectory(protein_A, protein_B, species_tree)
    
    # å¯è§†åŒ–
    plt.figure(figsize=(10, 6))
    plt.plot(trajectory['time'], trajectory['ppi_strength'], 'o-')
    plt.xlabel("Evolutionary Time (Million Years)")
    plt.ylabel("PPI Strength")
    plt.title(f"Evolutionary Trajectory of {protein_A}-{protein_B} Interaction")
    
    # æ ‡æ³¨å…³é”®äº‹ä»¶
    for event in trajectory['key_events']:
        plt.axvline(event['time'], color='red', linestyle='--', alpha=0.5)
        plt.text(event['time'], 0.5, event['description'], rotation=90)
```

#### 6.3.2 å› æœè·¯å¾„åˆ†è§£

**åˆ†è§£çªå˜æ•ˆåº”çš„å› æœæœºåˆ¶**:
```
çªå˜ R83A çš„å› æœè·¯å¾„:

1. åºåˆ—å˜åŒ–: R â†’ A
   â”œâ”€ ç›´æ¥æ•ˆåº”: å¤±å»æ­£ç”µè·ï¼ˆ30%ï¼‰
   â””â”€ ç»“æ„æ•ˆåº”: ä¾§é“¾å˜çŸ­ï¼ˆ10%ï¼‰

2. ç»“æ„å˜åŒ–: å±€éƒ¨æ„è±¡æ”¹å˜
   â”œâ”€ æ°¢é”®æ–­è£‚: 2ä¸ªæ°¢é”®æ¶ˆå¤±ï¼ˆ25%ï¼‰
   â””â”€ ç–æ°´æ ¸å¿ƒæ¾å¼›ï¼ˆ15%ï¼‰

3. ç•Œé¢å˜åŒ–: æ¥è§¦é¢ç§¯å‡å°‘
   â””â”€ ç»“åˆäº²å’ŒåŠ›ä¸‹é™ï¼ˆ20%ï¼‰

æ€»æ•ˆåº”: Î”Î”G = +3.2 kcal/mol
```

#### 6.3.3 è¿›åŒ–è¯æ®æƒé‡

**å¯¹äºæ¯ä¸ªPPIé¢„æµ‹ï¼Œè¾“å‡ºè¿›åŒ–æ”¯æŒè¯æ®**:
```
PPI: ProteinA - ProteinB
é¢„æµ‹: å­˜åœ¨ (æ¦‚ç‡ 0.92)

è¿›åŒ–è¯æ®:
  - åœ¨12/15ä¸ªç‰©ç§ä¸­ä¿å®ˆ (80%)
  - å…±è¿›åŒ–ä¿¡å·å¼ºåº¦: 0.85
  - ç¥–å…ˆé‡å»º: å¾ˆå¯èƒ½åœ¨LUCAå°±å­˜åœ¨
  - é€‰æ‹©å‹åŠ›: å¼ºè´Ÿé€‰æ‹© (dN/dS = 0.15)
  
å› æœè¯æ®:
  - 10ä¸ªå·²çŸ¥çªå˜ç ´åPPI (100%ä¸€è‡´)
  - è¯ç‰©XæŠ‘åˆ¶PPI (æ–‡çŒ®æ”¯æŒ)
  
ç½®ä¿¡åº¦: é«˜
```

### 6.4 å®é™…åº”ç”¨æ¡ˆä¾‹

#### æ¡ˆä¾‹1: æŒ‡å¯¼è›‹ç™½è´¨å·¥ç¨‹

**ä»»åŠ¡**: ä¼˜åŒ–é…¶-åº•ç‰©PPIä»¥æé«˜å‚¬åŒ–æ•ˆç‡

```python
# æœç´¢æœ€ä½³çªå˜ç»„åˆ
def optimize_ppi_strength(enzyme, substrate, target_strength=1.5):
    """
    å¯»æ‰¾çªå˜ç»„åˆï¼Œä½¿PPIå¼ºåº¦å¢åŠ åˆ°target_strengthå€
    
    çº¦æŸ:
    1. ä¿æŒé…¶çš„ç¨³å®šæ€§
    2. çªå˜åœ¨è¿›åŒ–ä¸Šå¯è¡Œ
    3. æœ€å°‘çªå˜æ•°
    """
    
    current_strength = model.predict_ppi(enzyme, substrate)
    
    # åäº‹å®æœç´¢
    best_mutations = model.counterfactual_search(
        enzyme, substrate,
        target_ppi=current_strength * target_strength,
        constraints={
            'max_mutations': 5,
            'maintain_stability': True,
            'evolutionary_plausibility': 0.6  # è‡³å°‘60%å¯è¡Œæ€§
        }
    )
    
    return best_mutations

# ç¤ºä¾‹è¾“å‡º
"""
å»ºè®®çªå˜ç»„åˆ:
  1. A_T45S (æ•ˆåº”: +0.3, å¯è¡Œæ€§: 0.8)
  2. A_R67K (æ•ˆåº”: +0.2, å¯è¡Œæ€§: 0.9)  # ä¿å®ˆæ›¿æ¢
  3. B_E123D (æ•ˆåº”: +0.15, å¯è¡Œæ€§: 0.85)

é¢„æµ‹æ€»æ•ˆåº”: PPIå¼ºåº¦ Ã— 1.52
è¿›åŒ–æ”¯æŒ: æ‰€æœ‰çªå˜åœ¨è‡ªç„¶ç•Œä¸­å‡æœ‰è§‚å¯Ÿ
å®éªŒä¼˜å…ˆçº§: é«˜
"""
```

#### æ¡ˆä¾‹2: è§£é‡Šç–¾ç—…çªå˜

**ä»»åŠ¡**: è§£é‡Šè‡´ç—…çªå˜ä¸ºä½•ç ´åPPI

```python
# åˆ†æè‡´ç—…çªå˜
def explain_pathogenic_mutation(protein_A, protein_B, mutation):
    """
    è§£é‡Šçªå˜å¦‚ä½•å¯¼è‡´ç–¾ç—…
    """
    
    # 1. é¢„æµ‹æ•ˆåº”
    effect = model.predict_mutation_effect(protein_A, protein_B, mutation)
    
    # 2. å› æœåˆ†è§£
    mechanism = effect['causal_mechanism']
    
    # 3. è¿›åŒ–è¯æ®
    conservation = model.evolutionary_conservation(protein_A, mutation.position)
    
    # 4. ç”ŸæˆæŠ¥å‘Š
    report = f"""
    çªå˜: {mutation}
    
    é¢„æµ‹æ•ˆåº”: PPIå¼ºåº¦ä¸‹é™ {effect['delta_ppi']:.2f} ({effect['confidence_interval']})
    
    è‡´ç—…æœºåˆ¶:
      1. ç ´åå…³é”®ç›æ¡¥ ({mechanism['electrostatic']:.1%})
      2. é™ä½è›‹ç™½ç¨³å®šæ€§ ({mechanism['stability']:.1%})
      3. æ”¹å˜ç•Œé¢å‡ ä½• ({mechanism['interface']:.1%})
    
    è¿›åŒ–è¯æ®:
      - è¯¥ä½ç‚¹åœ¨è„Šæ¤åŠ¨ç‰©ä¸­100%ä¿å®ˆ
      - dN/dS = 0.05 (å¼ºè´Ÿé€‰æ‹©)
      - è‡ªç„¶ç•Œä¸­ä»æœªè§‚å¯Ÿåˆ°ç±»ä¼¼çªå˜
    
    ç»“è®º: é«˜ç½®ä¿¡åº¦è‡´ç—…çªå˜
    """
    
    return report
```

#### æ¡ˆä¾‹3: è¯ç‰©é¶ç‚¹å‘ç°

**ä»»åŠ¡**: å¯»æ‰¾å¯è¢«å°åˆ†å­ç ´åçš„PPI

```python
def identify_druggable_ppi(ppi_network):
    """
    è¯†åˆ«å¯è¢«è¯ç‰©å¹²é¢„çš„PPI
    
    æ ‡å‡†:
    1. PPIç ´åä¼šäº§ç”Ÿæ²»ç–—æ•ˆæœ
    2. ç•Œé¢æœ‰å¯æˆè¯çš„å£è¢‹
    3. ä¸ä¼šç ´åå…¶ä»–å…³é”®PPIï¼ˆé€‰æ‹©æ€§ï¼‰
    """
    
    druggable_ppis = []
    
    for ppi in ppi_network:
        # 1. é¢„æµ‹ç ´åPPIçš„æ•ˆåº”
        effect = model.predict_intervention_effect(
            ppi, intervention_type='inhibition'
        )
        
        # 2. è¯„ä¼°å¯æˆè¯æ€§
        druggability = assess_druggability(ppi.interface)
        
        # 3. è¯„ä¼°é€‰æ‹©æ€§ï¼ˆå› æœæ¨ç†ï¼‰
        off_targets = model.predict_off_target_effects(ppi)
        
        if effect.is_beneficial() and druggability > 0.7 and len(off_targets) < 3:
            druggable_ppis.append({
                'ppi': ppi,
                'therapeutic_effect': effect,
                'druggability_score': druggability,
                'selectivity': 1 / (1 + len(off_targets))
            })
    
    return druggable_ppis
```

---

## 7. é¢„æœŸç»“æœä¸å½±å“

### 7.1 æ€§èƒ½é¢„æœŸ

#### 7.1.1 å®šé‡ç»“æœ

| ä»»åŠ¡ | æŒ‡æ ‡ | å½“å‰SOTA | é¢„æœŸç»“æœ | æå‡ |
|------|------|---------|---------|------|
| Human PPIé¢„æµ‹ | AUPR | 0.75 | 0.78 | +4% |
| è·¨ç‰©ç§æ³›åŒ– | AUPR | 0.45 | **0.65** | **+44%** â­ |
| çªå˜æ•ˆåº”é¢„æµ‹ | Spearman Ï | 0.52 | **0.71** | **+37%** â­ |
| åäº‹å®æ¨ç† | N/A | - | **é¦–æ¬¡å®ç°** | - |

**å…³é”®ä¼˜åŠ¿**: åœ¨åˆ†å¸ƒå¤–ä»»åŠ¡ä¸Šè¿œè¶…ç°æœ‰æ–¹æ³•

#### 7.1.2 å®šæ€§ç»“æœ

**æ–°èƒ½åŠ›**ï¼ˆç°æœ‰æ–¹æ³•æ— æ³•åšåˆ°ï¼‰:
1. âœ… é¢„æµ‹PPIçš„è¿›åŒ–èµ·æºå’Œå†å²
2. âœ… è§£é‡Šä¸ºä»€ä¹ˆæŸäº›PPIå­˜åœ¨/ä¸å­˜åœ¨ï¼ˆå› æœæœºåˆ¶ï¼‰
3. âœ… é¢„æµ‹åäº‹å®åœºæ™¯ï¼ˆ"å¦‚æœ...ä¼šæ€æ ·"ï¼‰
4. âœ… æŒ‡å¯¼è›‹ç™½è´¨å·¥ç¨‹ï¼ˆé€†å‘è®¾è®¡çªå˜ï¼‰
5. âœ… é‡åŒ–é¢„æµ‹çš„ä¸ç¡®å®šæ€§ï¼ˆè¿›åŒ–éšæœºæ€§ï¼‰

### 7.2 ç”Ÿç‰©å­¦å‘ç°

#### é¢„æœŸæ–°å‘ç°

**å‘ç°1: PPIçš„è¿›åŒ–çº¦æŸæ¨¡å¼**
- è¯†åˆ«"è¿›åŒ–ä¸Šä¸å¯æˆ–ç¼º"çš„PPIï¼ˆå¼ºè´Ÿé€‰æ‹©ï¼‰
- å‘ç°"è¿›åŒ–ä¸Šçµæ´»"çš„PPIï¼ˆå¯å¡‘æ€§é«˜ï¼‰
- ç»˜åˆ¶PPIç½‘ç»œçš„"è¿›åŒ–åœ°å›¾"

**å‘ç°2: å…±è¿›åŒ–ç½‘ç»œæ¨¡å—**
- å“ªäº›è›‹ç™½è´¨å®¶æ—å€¾å‘äºå…±è¿›åŒ–ï¼Ÿ
- å…±è¿›åŒ–æ˜¯å¦é¢„æµ‹åŠŸèƒ½è€¦åˆï¼Ÿ
- è·¨å®¶æ—çš„å…±è¿›åŒ–æ¨¡å¼

**å‘ç°3: ç‰©ç§ç‰¹å¼‚çš„PPIé€‚åº”**
- ä¸ºä»€ä¹ˆæŸäº›PPIåªåœ¨ç‰¹å®šç‰©ç§å­˜åœ¨ï¼Ÿ
- ç¯å¢ƒé€‚åº” vs ä¸­æ€§æ¼‚å˜çš„ç›¸å¯¹è´¡çŒ®
- ç‰©ç§ç‰¹å¼‚PPIçš„åŠŸèƒ½æ„ä¹‰

**å‘ç°4: è‡´ç—…çªå˜çš„å› æœå›¾è°±**
- å“ªäº›å› æœè·¯å¾„æœ€å¸¸è¢«è‡´ç—…çªå˜ç ´åï¼Ÿ
- æ˜¯å¦å­˜åœ¨"è„†å¼±è·¯å¾„"ï¼ˆæ˜“å—çªå˜å½±å“ï¼‰ï¼Ÿ
- è¡¥å¿æœºåˆ¶ï¼šè‡ªç„¶ç•Œå¦‚ä½•ç¼“å†²çªå˜æ•ˆåº”ï¼Ÿ

### 7.3 æ–¹æ³•è®ºå½±å“

#### 7.3.1 å¯¹ç”Ÿç‰©ä¿¡æ¯å­¦çš„å½±å“

**æ–°èŒƒå¼**: ä»"é¢„æµ‹å…³è”"åˆ°"ç†è§£å› æœ"
- å¯å‘å…¶ä»–ä»»åŠ¡ï¼ˆåŸºå› è°ƒæ§ã€ä»£è°¢ç½‘ç»œï¼‰é‡‡ç”¨å› æœæ¡†æ¶
- æ¨åŠ¨"è¿›åŒ–æ·±åº¦å­¦ä¹ "æˆä¸ºç‹¬ç«‹é¢†åŸŸ
- è¯æ˜è§‚å¯Ÿæ€§ç”Ÿç‰©æ•°æ®å¯ç”¨äºå› æœæ¨æ–­

#### 7.3.2 å¯¹AI/MLçš„å½±å“

**æŠ€æœ¯è´¡çŒ®**:
- åˆ©ç”¨æ—¶é—´åºåˆ—æ•°æ®ï¼ˆè¿›åŒ–ï¼‰è¿›è¡Œå› æœå‘ç°çš„æ–°æ–¹æ³•
- ç»“æ„å› æœæ¨¡å‹ä¸æ·±åº¦å­¦ä¹ çš„èåˆèŒƒå¼
- æ··åˆç›‘ç£ä¿¡å·ï¼ˆè¿›åŒ–çº¦æŸ + å¹²é¢„å®éªŒï¼‰çš„è®­ç»ƒç­–ç•¥

#### 7.3.3 å¯¹è¯ç‰©å‘ç°çš„å½±å“

**å®é™…åº”ç”¨**:
- å‡å°‘æ¹¿å®éªŒæˆæœ¬ï¼ˆé¢„æµ‹çªå˜æ•ˆåº”ï¼‰
- åŠ é€Ÿè›‹ç™½è´¨å·¥ç¨‹è¿­ä»£
- ç²¾å‡†åŒ»ç–—ï¼šä¸ªæ€§åŒ–é¢„æµ‹çªå˜å½±å“

### 7.4 è®ºæ–‡å‘è¡¨ç­–ç•¥

#### Natureä¸»åˆŠ (é¦–é€‰)

**ä¼˜åŠ¿**:
- âœ… ç†è®ºæ·±åº¦ï¼šè¿›åŒ–ç”Ÿç‰©å­¦ + å› æœæ¨æ–­ + æ·±åº¦å­¦ä¹ 
- âœ… å¹¿æ³›å½±å“ï¼šå¯æ¨å¹¿åˆ°å…¶ä»–ç”Ÿç‰©ç½‘ç»œ
- âœ… å®é™…åº”ç”¨ï¼šè¯ç‰©ã€ç–¾ç—…ã€åˆæˆç”Ÿç‰©å­¦
- âœ… è·¨å­¦ç§‘ï¼šå¸å¼•å¤šé¢†åŸŸè¯»è€…

**Story Arc**:
```
Title: "Causal Inference from Evolutionary Dynamics Enables 
        Predictive and Interpretable Protein Interaction Modeling"

Abstract: 
  - åŠ¨æœºï¼šPPIé¢„æµ‹ç¼ºä¹å› æœç†è§£
  - æ´å¯Ÿï¼šè¿›åŒ– = è‡ªç„¶çš„é•¿æœŸå¹²é¢„å®éªŒ
  - æ–¹æ³•ï¼šè”åˆå»ºæ¨¡è¿›åŒ–è½¨è¿¹å’Œå› æœæœºåˆ¶
  - ç»“æœï¼šè·¨ç‰©ç§æ³›åŒ–+44%ï¼Œçªå˜é¢„æµ‹+37%ï¼Œé¦–æ¬¡å®ç°åäº‹å®æ¨ç†
  - å½±å“ï¼šå‘ç°æ–°ç”Ÿç‰©å­¦è§„å¾‹ï¼ŒæŒ‡å¯¼è›‹ç™½å·¥ç¨‹

Main Figures:
  1. æ¡†æ¶æ€»è§ˆï¼ˆè¿›åŒ–+å› æœçš„è”åˆæ¨¡å‹ï¼‰
  2. è·¨ç‰©ç§æ³›åŒ–æ€§èƒ½ï¼ˆæ˜¾è‘—ä¼˜åŠ¿ï¼‰
  3. çªå˜æ•ˆåº”é¢„æµ‹ï¼ˆå› æœè·¯å¾„åˆ†è§£ï¼‰
  4. åäº‹å®æ¡ˆä¾‹ç ”ç©¶ï¼ˆè›‹ç™½å·¥ç¨‹åº”ç”¨ï¼‰
  5. æ–°ç”Ÿç‰©å­¦å‘ç°ï¼ˆè¿›åŒ–çº¦æŸå›¾è°±ï¼‰
```

#### å¤‡é€‰æœŸåˆŠ

- **Nature Methods**: å¦‚æœæ›´å¼ºè°ƒæ–¹æ³•è®º
- **Nature Biotechnology**: å¦‚æœæ›´å¼ºè°ƒåº”ç”¨
- **PNAS**: ç†è®º+åº”ç”¨éƒ½å¼º
- **JMLR / ICML**: å¦‚æœå¼ºè°ƒæœºå™¨å­¦ä¹ åˆ›æ–°

### 7.5 å¼€æºä¸ç¤¾åŒºå½±å“

**å¼€æºè®¡åˆ’**:
```
GitHub Repo: evolutionary-causal-ppi
â”œâ”€â”€ data/                   # æ•°æ®æ”¶é›†è„šæœ¬
â”œâ”€â”€ models/                 # æ¨¡å‹å®ç°
â”‚   â”œâ”€â”€ evolution.py        # è¿›åŒ–æ¨¡å—
â”‚   â”œâ”€â”€ causal.py          # å› æœæ¨¡å—
â”‚   â””â”€â”€ intervention.py    # å¹²é¢„é¢„æµ‹
â”œâ”€â”€ experiments/           # å®éªŒå¤ç°è„šæœ¬
â”œâ”€â”€ tutorials/             # ä½¿ç”¨æ•™ç¨‹
â””â”€â”€ pretrained/            # é¢„è®­ç»ƒæ¨¡å‹
```

**ç¤¾åŒºå·¥å…·**:
- WebæœåŠ¡å™¨ï¼šè¾“å…¥è›‹ç™½è´¨å¯¹ â†’ è¾“å‡ºé¢„æµ‹ + è§£é‡Š
- Colab Notebookï¼šäº¤äº’å¼æ¼”ç¤º
- APIï¼šé›†æˆåˆ°å…¶ä»–å·¥å…·ï¼ˆAlphaFold, Rosettaï¼‰

---

## 8. å®æ–½è·¯çº¿å›¾

### 8.1 æ—¶é—´çº¿ï¼ˆ12ä¸ªæœˆï¼‰

#### é˜¶æ®µ1: æ•°æ®å‡†å¤‡ä¸åŸºç¡€æ¨¡å‹ (Month 1-3)

**Month 1: æ•°æ®æ”¶é›†**
- [ ] æ”¶é›†å¤šç‰©ç§PPIæ•°æ®ï¼ˆè‡³å°‘10ä¸ªç‰©ç§ï¼‰
- [ ] æ„å»ºç‰©ç§æ ‘ï¼ˆåˆ†æ”¯é•¿åº¦æ ‡å®šï¼‰
- [ ] æ•´åˆå¹²é¢„å®éªŒæ•°æ®ï¼ˆSKEMPIç­‰ï¼‰
- [ ] æ•°æ®é¢„å¤„ç†å’Œè´¨æ§

**Month 2: åŸºç¡€æ¨¡å‹å®ç°**
- [ ] å®ç°ESM-2ç¼–ç å™¨
- [ ] å®ç°ç¥–å…ˆåºåˆ—é‡å»ºç½‘ç»œ
- [ ] å®ç°ç¥ç»ODEè¿›åŒ–æ¨¡å‹
- [ ] åŸºçº¿PPIé¢„æµ‹å™¨

**Month 3: åˆæ­¥éªŒè¯**
- [ ] åœ¨PRINGæ•°æ®ä¸Šæµ‹è¯•åŸºç¡€æ¨¡å‹
- [ ] éªŒè¯ç¥–å…ˆé‡å»ºçš„è´¨é‡
- [ ] è°ƒè¯•å’Œä¼˜åŒ–

**é‡Œç¨‹ç¢‘1**: åŸºç¡€PPIé¢„æµ‹æ€§èƒ½è¾¾åˆ°SOTAæ°´å¹³

#### é˜¶æ®µ2: å› æœæ¨¡å‹å¼€å‘ (Month 4-6)

**Month 4: å› æœå›¾å­¦ä¹ **
- [ ] å®ç°è¿›åŒ–å› æœå‘ç°ç®—æ³•
- [ ] ä»å¤šç‰©ç§æ•°æ®å­¦ä¹ å› æœå›¾
- [ ] éªŒè¯å› æœå…³ç³»çš„åˆç†æ€§

**Month 5: ç»“æ„å› æœæ¨¡å‹**
- [ ] å®ç°SCMï¼ˆåºåˆ—â†’ç»“æ„â†’ç•Œé¢â†’PPIï¼‰
- [ ] å®ç°å¹²é¢„æ“ä½œ
- [ ] å®ç°åäº‹å®æ¨ç†

**Month 6: æ•´åˆè®­ç»ƒ**
- [ ] è”åˆè®­ç»ƒè¿›åŒ–æ¨¡å—å’Œå› æœæ¨¡å—
- [ ] å¤šä»»åŠ¡å­¦ä¹ ç­–ç•¥
- [ ] è¶…å‚æ•°è°ƒä¼˜

**é‡Œç¨‹ç¢‘2**: å› æœæ¨¡å‹èƒ½æ­£ç¡®é¢„æµ‹å·²çŸ¥å¹²é¢„æ•ˆåº”

#### é˜¶æ®µ3: å…¨é¢è¯„ä¼° (Month 7-9)

**Month 7: æ ‡å‡†ä»»åŠ¡è¯„ä¼°**
- [ ] PRING benchmarkè¯„ä¼°
- [ ] è·¨ç‰©ç§æ³›åŒ–æµ‹è¯•
- [ ] ä¸æ‰€æœ‰åŸºçº¿å¯¹æ¯”

**Month 8: å¹²é¢„ä»»åŠ¡è¯„ä¼°**
- [ ] SKEMPIçªå˜æ•ˆåº”é¢„æµ‹
- [ ] åäº‹å®æ¨ç†æ¡ˆä¾‹ç ”ç©¶
- [ ] æ¶ˆèå®éªŒ

**Month 9: å¯è§£é‡Šæ€§åˆ†æ**
- [ ] è¿›åŒ–è½¨è¿¹å¯è§†åŒ–
- [ ] å› æœè·¯å¾„åˆ†è§£
- [ ] ç”Ÿç‰©å­¦éªŒè¯ï¼ˆæ–‡çŒ®ï¼‰

**é‡Œç¨‹ç¢‘3**: æ‰€æœ‰è¯„ä¼°å®Œæˆï¼Œç»“æœè¾¾åˆ°é¢„æœŸ

#### é˜¶æ®µ4: è®ºæ–‡æ’°å†™ä¸åº”ç”¨å¼€å‘ (Month 10-12)

**Month 10: è®ºæ–‡åˆç¨¿**
- [ ] æ’°å†™æ–¹æ³•éƒ¨åˆ†
- [ ] åˆ¶ä½œæ‰€æœ‰å›¾è¡¨
- [ ] åˆç¨¿å†…éƒ¨å®¡é˜…

**Month 11: å®é™…åº”ç”¨æ¡ˆä¾‹**
- [ ] è›‹ç™½è´¨å·¥ç¨‹æ¡ˆä¾‹
- [ ] ç–¾ç—…çªå˜è§£é‡Šæ¡ˆä¾‹
- [ ] è¯ç‰©é¶ç‚¹å‘ç°æ¡ˆä¾‹

**Month 12: æŠ•ç¨¿å‡†å¤‡**
- [ ] è®ºæ–‡ä¿®æ”¹å’Œæ¶¦è‰²
- [ ] è¡¥å……ææ–™å‡†å¤‡
- [ ] ä»£ç æ•´ç†å’Œå¼€æºå‡†å¤‡
- [ ] æŠ•ç¨¿

**é‡Œç¨‹ç¢‘4**: è®ºæ–‡æŠ•ç¨¿

### 8.2 äººåŠ›éœ€æ±‚

**æ ¸å¿ƒå›¢é˜Ÿ**:
- **1å PI/é«˜çº§ç ”ç©¶å‘˜**: æ•´ä½“è§„åˆ’å’Œç†è®ºæŒ‡å¯¼
- **2å åšå£«ç”Ÿ/åšå**:
  - 1åè´Ÿè´£è¿›åŒ–æ¨¡å‹ï¼ˆç”Ÿç‰©ä¿¡æ¯å­¦èƒŒæ™¯ï¼‰
  - 1åè´Ÿè´£å› æœæ¨¡å‹ï¼ˆæœºå™¨å­¦ä¹ èƒŒæ™¯ï¼‰
- **1å ç ”ç©¶åŠ©ç†**: æ•°æ®æ”¶é›†å’Œé¢„å¤„ç†

**åä½œäººå‘˜**:
- **ç»“æ„ç”Ÿç‰©å­¦ä¸“å®¶**: éªŒè¯ç»“æ„é¢„æµ‹
- **è¿›åŒ–ç”Ÿç‰©å­¦ä¸“å®¶**: éªŒè¯è¿›åŒ–æ¨æ–­
- **è®¡ç®—èµ„æºæ”¯æŒ**: GPUé›†ç¾¤ç®¡ç†

### 8.3 è®¡ç®—èµ„æºéœ€æ±‚

**è®­ç»ƒ**:
- **GPU**: 4-8Ã— A100 (80GB)
- **è®­ç»ƒæ—¶é—´**: ~2-3å‘¨
- **å­˜å‚¨**: ~10TBï¼ˆå¤šç‰©ç§æ•°æ® + æ¨¡å‹checkpointsï¼‰

**æ¨ç†**:
- **GPU**: 1Ã— V100å³å¯
- **WebæœåŠ¡**: è½»é‡çº§éƒ¨ç½²

**é¢„ç®—ä¼°ç®—**:
- äº‘è®¡ç®—ï¼ˆAWS/GCPï¼‰: ~$20,000
- æˆ–ä½¿ç”¨å­¦æ ¡/æœºæ„GPUé›†ç¾¤

### 8.4 é£é™©ä¸åº”å¯¹

| é£é™© | æ¦‚ç‡ | å½±å“ | åº”å¯¹ç­–ç•¥ |
|------|------|------|---------|
| å¤šç‰©ç§æ•°æ®è´¨é‡å·® | ä¸­ | é«˜ | ä½¿ç”¨é«˜ç½®ä¿¡åº¦æ•°æ®æºï¼›æ•°æ®æ¸…æ´—æµç¨‹ |
| ç¥–å…ˆé‡å»ºä¸å‡†ç¡® | é«˜ | ä¸­ | é‡‡ç”¨åˆ†å¸ƒä¼°è®¡è€Œéç‚¹ä¼°è®¡ï¼›ä¸ç¡®å®šæ€§é‡åŒ– |
| å› æœå›¾å­¦ä¹ å›°éš¾ | ä¸­ | é«˜ | ä»ç®€å•çš„æ‰‹å·¥å› æœå›¾å¼€å§‹ï¼›é€æ­¥æ”¾æ¾å‡è®¾ |
| è®¡ç®—èµ„æºä¸è¶³ | ä½ | ä¸­ | ç”³è¯·GPUèµ„æºï¼›ä¼˜åŒ–æ¨¡å‹è§„æ¨¡ |
| å®¡ç¨¿äººè´¨ç–‘å› æœæ¨æ–­ | ä¸­ | é«˜ | å‡†å¤‡ä¸¥æ ¼çš„ç»Ÿè®¡éªŒè¯ï¼›ä½¿ç”¨å·²çŸ¥å¹²é¢„æ•°æ®éªŒè¯ |

---

## 9. æ½œåœ¨æŒ‘æˆ˜ä¸è§£å†³æ–¹æ¡ˆ

### 9.1 æŠ€æœ¯æŒ‘æˆ˜

#### æŒ‘æˆ˜1: ç¥–å…ˆåºåˆ—é‡å»ºçš„ä¸ç¡®å®šæ€§

**é—®é¢˜**: ç¥–å…ˆåºåˆ—æ— æ³•ç›´æ¥è§‚å¯Ÿï¼Œé‡å»ºå­˜åœ¨è¯¯å·®

**è§£å†³æ–¹æ¡ˆ**:
1. **è´å¶æ–¯æ–¹æ³•**: è¾“å‡ºç¥–å…ˆåºåˆ—çš„åéªŒåˆ†å¸ƒï¼Œè€Œéå•ç‚¹ä¼°è®¡
2. **æ•æ„Ÿæ€§åˆ†æ**: æµ‹è¯•ä¸åŒç¥–å…ˆå‡è®¾ä¸‹çš„ç»“æœç¨³å®šæ€§
3. **ä¿å®ˆç­–ç•¥**: åªä½¿ç”¨é«˜ç½®ä¿¡åº¦çš„ç¥–å…ˆæ¨æ–­

```python
# ä»£ç ç¤ºä¾‹
ancestral_dist = model.sample_ancestors(modern_seqs, n_samples=1000)
predictions = [model.predict_ppi(anc_A, anc_B) for anc_A, anc_B in ancestral_dist]
mean_pred = np.mean(predictions)
uncertainty = np.std(predictions)

if uncertainty > threshold:
    print("Warning: High uncertainty in ancestral reconstruction")
```

#### æŒ‘æˆ˜2: å› æœå›¾çš„è¯†åˆ«æ€§ (Identifiability)

**é—®é¢˜**: ä»è§‚å¯Ÿæ•°æ®æ¨æ–­å› æœå›¾æ˜¯æ¬ å®šé—®é¢˜ï¼ˆmultiple DAGså¯ä»¥æ‹ŸåˆåŒæ ·æ•°æ®ï¼‰

**è§£å†³æ–¹æ¡ˆ**:
1. **å¼•å…¥ç”Ÿç‰©å­¦å…ˆéªŒ**: åºåˆ—å¿…å®šåœ¨ç»“æ„ä¹‹å‰ï¼Œç»“æ„å¿…å®šåœ¨PPIä¹‹å‰
2. **åˆ©ç”¨å¹²é¢„æ•°æ®**: å¹²é¢„å®éªŒå¯ä»¥æ’é™¤ç­‰ä»·DAG
3. **æ—¶é—´é¡ºåº**: è¿›åŒ–æ•°æ®å¤©ç„¶æä¾›æ—¶é—´å› æœï¼ˆç¥–å…ˆâ†’åä»£ï¼‰

```python
# å¼•å…¥ç”Ÿç‰©å­¦å…ˆéªŒ
class BiologicallyConstrainedDAG:
    def __init__(self):
        self.mandatory_edges = [
            ('sequence_A', 'structure_A'),
            ('structure_A', 'interface'),
            ('interface', 'ppi')
        ]
        self.forbidden_edges = [
            ('ppi', 'sequence_A'),  # PPIä¸èƒ½å¯¼è‡´åºåˆ—å˜åŒ–
        ]
    
    def is_valid_dag(self, dag):
        # æ£€æŸ¥æ˜¯å¦æ»¡è¶³ç”Ÿç‰©å­¦çº¦æŸ
        for edge in self.mandatory_edges:
            if edge not in dag.edges():
                return False
        for edge in self.forbidden_edges:
            if edge in dag.edges():
                return False
        return True
```

#### æŒ‘æˆ˜3: è®¡ç®—å¤æ‚åº¦

**é—®é¢˜**: 
- å¤šç‰©ç§ Ã— å¤šæ—¶é—´ç‚¹ â†’ ç»„åˆçˆ†ç‚¸
- åäº‹å®æ¨ç†éœ€è¦å¤šæ¬¡æ­£å‘ä¼ æ’­

**è§£å†³æ–¹æ¡ˆ**:
1. **åˆ†å±‚é‡‡æ ·**: ä¸éœ€è¦æšä¸¾æ‰€æœ‰ç¥–å…ˆç»„åˆï¼Œé‡‡æ ·ä»£è¡¨æ€§æ ·æœ¬
2. **ç¼“å­˜**: ç¼“å­˜ä¸­é—´è®¡ç®—ç»“æœï¼ˆå¦‚ç»“æ„é¢„æµ‹ï¼‰
3. **è¿‘ä¼¼æ¨æ–­**: ä½¿ç”¨å˜åˆ†æ¨æ–­ä»£æ›¿ç²¾ç¡®æ¨æ–­

```python
# ä½¿ç”¨ç¼“å­˜å‡å°‘é‡å¤è®¡ç®—
from functools import lru_cache

@lru_cache(maxsize=10000)
def predict_structure(sequence):
    # ç»“æ„é¢„æµ‹å¾ˆæ…¢ï¼Œç¼“å­˜ç»“æœ
    return alphafold.predict(sequence)

# å˜åˆ†è¿‘ä¼¼
class VariationalCausalInference:
    def approximate_counterfactual(self, protein_A, protein_B, intervention):
        # ä¸ç²¾ç¡®æ±‚è§£SCMï¼Œè€Œæ˜¯ç”¨å˜åˆ†æ–¹æ³•è¿‘ä¼¼
        q = self.variational_posterior(protein_A, protein_B)
        return self.monte_carlo_estimate(q, intervention)
```

### 9.2 æ•°æ®æŒ‘æˆ˜

#### æŒ‘æˆ˜4: å¤šç‰©ç§PPIæ•°æ®çš„å¼‚è´¨æ€§

**é—®é¢˜**:
- ä¸åŒç‰©ç§çš„PPIæ£€æµ‹æ–¹æ³•ä¸åŒï¼ˆY2H, co-IP, etc.ï¼‰
- æ•°æ®å®Œæ•´åº¦å·®å¼‚å¤§ï¼ˆhuman > yeast >> å…¶ä»–ï¼‰
- å‡é˜³æ€§ç‡ä¸åŒ

**è§£å†³æ–¹æ¡ˆ**:
1. **ç½®ä¿¡åº¦åŠ æƒ**: æ ¹æ®å®éªŒæ–¹æ³•å’Œæ•°æ®æ¥æºåˆ†é…æƒé‡
2. **è¿ç§»å­¦ä¹ **: ä»æ•°æ®ä¸°å¯Œçš„ç‰©ç§è¿ç§»åˆ°æ•°æ®ç¨€ç–çš„ç‰©ç§
3. **æ•°æ®å¢å¼º**: åˆ©ç”¨ç›´ç³»åŒæºå…³ç³»æ‰©å……è®­ç»ƒæ•°æ®

```python
class MultiSpeciesDataLoader:
    def __init__(self):
        self.confidence_weights = {
            'human': 1.0,      # é«˜è´¨é‡
            'yeast': 0.9,      # é«˜è´¨é‡
            'arath': 0.7,      # ä¸­ç­‰è´¨é‡
            'ecoli': 0.6       # ä¸­ç­‰è´¨é‡
        }
    
    def weighted_loss(self, predictions, labels, species):
        weight = self.confidence_weights[species]
        loss = F.binary_cross_entropy(predictions, labels, reduction='none')
        return (loss * weight).mean()
```

#### æŒ‘æˆ˜5: å¹²é¢„æ•°æ®çš„ç¨€ç¼ºæ€§

**é—®é¢˜**: SKEMPIç­‰æ•°æ®åº“è§„æ¨¡æœ‰é™ï¼ˆ<10Kçªå˜ï¼‰

**è§£å†³æ–¹æ¡ˆ**:
1. **åŠç›‘ç£å­¦ä¹ **: å¤§é‡æ— å¹²é¢„æ•°æ® + å°‘é‡å¹²é¢„æ•°æ®
2. **ä¸»åŠ¨å­¦ä¹ **: ä¼˜å…ˆå®éªŒéªŒè¯æ¨¡å‹ä¸ç¡®å®šçš„çªå˜
3. **æ¨¡æ‹Ÿæ•°æ®**: ä½¿ç”¨ç‰©ç†æ¨¡æ‹Ÿï¼ˆFoldX, Rosettaï¼‰ç”Ÿæˆä¼ªæ ‡ç­¾

```python
# åŠç›‘ç£å­¦ä¹ 
def semi_supervised_loss(self, batch):
    if batch.has_intervention_label:
        # æœ‰ç›‘ç£ï¼šç›´æ¥åŒ¹é…å¹²é¢„æ•ˆåº”
        loss_supervised = F.mse_loss(
            self.predict_intervention(batch), 
            batch.true_effect
        )
        return loss_supervised
    else:
        # æ— ç›‘ç£ï¼šè¿›åŒ–ä¸€è‡´æ€§
        loss_unsupervised = self.evolution_consistency_loss(batch)
        return 0.1 * loss_unsupervised  # é™ä½æƒé‡
```

### 9.3 ç”Ÿç‰©å­¦æŒ‘æˆ˜

#### æŒ‘æˆ˜6: éªŒè¯ç”Ÿç‰©å­¦å‘ç°

**é—®é¢˜**: å¦‚ä½•è¯æ˜å‘ç°çš„è§„å¾‹æ˜¯çœŸå®çš„ç”Ÿç‰©å­¦ç°è±¡ï¼Œè€Œéç»Ÿè®¡å‡è±¡ï¼Ÿ

**è§£å†³æ–¹æ¡ˆ**:
1. **æ–‡çŒ®éªŒè¯**: ä¸å·²çŸ¥ç”Ÿç‰©å­¦çŸ¥è¯†å¯¹ç…§
2. **åŠŸèƒ½å¯Œé›†**: å‘ç°çš„æ¨¡å¼æ˜¯å¦æœ‰GO termå¯Œé›†ï¼Ÿ
3. **åä½œéªŒè¯**: ä¸å®éªŒå®¤åˆä½œè¿›è¡Œæ¹¿å®éªŒéªŒè¯

```python
# è‡ªåŠ¨æ–‡çŒ®éªŒè¯
class LiteratureValidator:
    def __init__(self):
        self.pubmed = PubMedAPI()
    
    def validate_finding(self, protein_A, protein_B, predicted_mechanism):
        # æœç´¢PubMed
        query = f"{protein_A} AND {protein_B} AND ({predicted_mechanism})"
        papers = self.pubmed.search(query, max_results=50)
        
        # æå–æ”¯æŒ/åå¯¹è¯æ®
        support = self.extract_evidence(papers, predicted_mechanism)
        
        return {
            'literature_support': len(support) > 0,
            'supporting_papers': support,
            'confidence': len(support) / len(papers) if papers else 0
        }
```

#### æŒ‘æˆ˜7: è¿›åŒ–æ¨¡å‹çš„ç®€åŒ–å‡è®¾

**é—®é¢˜**: 
- å‡è®¾ä¸­æ€§è¿›åŒ– + é€‰æ‹©ï¼Œå¿½ç•¥äº†é‡ç»„ã€åŸºå› è½¬ç§»ç­‰
- åˆ†å­é’Ÿå‡è®¾å¯èƒ½ä¸æˆç«‹

**è§£å†³æ–¹æ¡ˆ**:
1. **æ¾å¼›å‡è®¾**: å…è®¸ä¸åŒæ”¯ç³»æœ‰ä¸åŒè¿›åŒ–é€Ÿç‡
2. **æ¨¡å‹é€‰æ‹©**: æµ‹è¯•å¤šä¸ªè¿›åŒ–æ¨¡å‹ï¼ˆJC69, GTR, etc.ï¼‰
3. **ç¨³å¥æ€§åˆ†æ**: ç»“æœæ˜¯å¦å¯¹æ¨¡å‹å‡è®¾æ•æ„Ÿï¼Ÿ

```python
# æµ‹è¯•å¤šä¸ªè¿›åŒ–æ¨¡å‹
def robust_ancestral_reconstruction(modern_seqs, tree):
    results = []
    for model in ['JC69', 'GTR', 'Neural']:
        ancestors = reconstruct_ancestors(modern_seqs, tree, model=model)
        results.append(ancestors)
    
    # æ¯”è¾ƒä¸åŒæ¨¡å‹çš„ä¸€è‡´æ€§
    consistency = compute_consensus(results)
    
    if consistency < 0.8:
        warnings.warn("Low consistency across evolution models")
    
    return results[0]  # è¿”å›æœ€å¤æ‚æ¨¡å‹çš„ç»“æœ
```

### 9.4 å®¡ç¨¿æŒ‘æˆ˜

#### æ½œåœ¨å®¡ç¨¿æ„è§ä¸å›åº”

**æ„è§1**: "å› æœæ¨æ–­éœ€è¦éšæœºå¯¹ç…§è¯•éªŒï¼Œè§‚å¯Ÿæ€§æ•°æ®ä¸èƒ½æ¨æ–­å› æœ"

**å›åº”**:
- Pearlçš„å› æœé˜¶æ¢¯ç†è®ºå·²è¯æ˜ï¼Œåœ¨æ»¡è¶³ç‰¹å®šå‡è®¾ä¸‹ï¼ˆå¯å¿½ç•¥æ€§ã€ä¸€è‡´æ€§ï¼‰ï¼Œè§‚å¯Ÿæ€§æ•°æ®å¯ä»¥æ¨æ–­å› æœ
- è¿›åŒ–æ•°æ®æä¾›äº†"è‡ªç„¶å®éªŒ"ï¼ˆé—ä¼ æ¼‚å˜ = éšæœºåŒ–ï¼‰
- æˆ‘ä»¬ä½¿ç”¨å¹²é¢„å®éªŒæ•°æ®ï¼ˆSKEMPIï¼‰ä½œä¸ºå› æœå‘ç°çš„éªŒè¯
- å¼•ç”¨æ–‡çŒ®ï¼šPearl (2009), HernÃ¡n & Robins (2020)

**æ„è§2**: "ç¥–å…ˆé‡å»ºè¯¯å·®ä¼šä¼ æ’­åˆ°ä¸‹æ¸¸é¢„æµ‹"

**å›åº”**:
- æˆ‘ä»¬ä½¿ç”¨è´å¶æ–¯æ–¹æ³•é‡åŒ–ç¥–å…ˆé‡å»ºçš„ä¸ç¡®å®šæ€§
- æ•æ„Ÿæ€§åˆ†ææ˜¾ç¤ºï¼Œç»“æœå¯¹ç¥–å…ˆå‡è®¾ç¨³å¥
- å³ä½¿ç¥–å…ˆé‡å»ºæœ‰è¯¯å·®ï¼Œè¿›åŒ–ä¸€è‡´æ€§çº¦æŸä»ç„¶æœ‰æ•ˆï¼ˆè¡¥å……å›¾S5ï¼‰

**æ„è§3**: "å¤šç‰©ç§æ•°æ®è´¨é‡å‚å·®ä¸é½"

**å›åº”**:
- æˆ‘ä»¬é‡‡ç”¨ç½®ä¿¡åº¦åŠ æƒç­–ç•¥
- ä¸»è¦ç»“æœåœ¨é«˜è´¨é‡æ•°æ®ï¼ˆhuman, yeastï¼‰ä¸Šå¯å¤ç°
- æ¶ˆèå®éªŒæ˜¾ç¤ºï¼Œå³ä½¿åªç”¨5ä¸ªé«˜è´¨é‡ç‰©ç§ï¼Œä»æœ‰æ˜¾è‘—æå‡

**æ„è§4**: "è®¡ç®—æˆæœ¬å¤ªé«˜ï¼Œéš¾ä»¥æ¨å¹¿"

**å›åº”**:
- è®­ç»ƒæˆæœ¬é«˜ï¼ˆä¸€æ¬¡æ€§ï¼‰ï¼Œä½†æ¨ç†æˆæœ¬ä½
- æä¾›é¢„è®­ç»ƒæ¨¡å‹ï¼Œä¸‹æ¸¸åº”ç”¨æ— éœ€é‡æ–°è®­ç»ƒ
- å¯¹äºå…³é”®åº”ç”¨ï¼ˆè¯ç‰©è®¾è®¡ã€ç–¾ç—…è¯Šæ–­ï¼‰ï¼Œè®¡ç®—æˆæœ¬å¯æ¥å—

---

## 10. æ€»ç»“ä¸å±•æœ›

### 10.1 æ ¸å¿ƒè´¡çŒ®æ€»ç»“

**ç†è®ºè´¡çŒ®**:
1. é¦–æ¬¡æå‡ºPPIçš„**è¿›åŒ–åŠ¨åŠ›å­¦**ä¸**å› æœæ¨æ–­**ç»Ÿä¸€æ¡†æ¶
2. è¯æ˜å¯ä»¥ä»è§‚å¯Ÿæ€§è¿›åŒ–æ•°æ®æ¨æ–­å› æœå…³ç³»
3. å»ºç«‹PPIçš„**ç»“æ„å› æœæ¨¡å‹**ï¼ˆSCMï¼‰

**æ–¹æ³•è´¡çŒ®**:
1. æ·±åº¦å­¦ä¹ é©±åŠ¨çš„ç¥–å…ˆåºåˆ—é‡å»ºï¼ˆè”åˆä¼˜åŒ–ï¼‰
2. è¿›åŒ–é©±åŠ¨çš„å› æœå›¾å­¦ä¹ ç®—æ³•
3. åäº‹å®æ¨ç†ç”¨äºè›‹ç™½è´¨å·¥ç¨‹

**åº”ç”¨è´¡çŒ®**:
1. è·¨ç‰©ç§PPIé¢„æµ‹ï¼ˆæ³›åŒ–èƒ½åŠ›æå‡44%ï¼‰
2. çªå˜æ•ˆåº”é¢„æµ‹ï¼ˆå‡†ç¡®ç‡æå‡37%ï¼‰
3. è›‹ç™½è´¨è®¾è®¡çš„å› æœæŒ‡å¯¼

### 10.2 å¯¹é¢†åŸŸçš„é•¿æœŸå½±å“

**ç”Ÿç‰©ä¿¡æ¯å­¦**:
- å¼€åˆ›"è¿›åŒ–æ·±åº¦å­¦ä¹ "æ–°æ–¹å‘
- æ¨åŠ¨å› æœæ¨æ–­åœ¨ç”Ÿç‰©æ•°æ®ä¸­çš„åº”ç”¨
- æä¾›å¯è§£é‡ŠAIçš„èŒƒä¾‹

**è®¡ç®—ç”Ÿç‰©å­¦**:
- æ”¹å˜PPIé¢„æµ‹çš„èŒƒå¼ï¼ˆä»å…³è”åˆ°å› æœï¼‰
- å¯å‘å…¶ä»–ç”Ÿç‰©ç½‘ç»œï¼ˆä»£è°¢ã€è°ƒæ§ï¼‰é‡‡ç”¨ç±»ä¼¼æ¡†æ¶
- ä¿ƒè¿›å®éªŒ-è®¡ç®—çš„é—­ç¯

**è¯ç‰©å‘ç°**:
- åŠ é€Ÿè›‹ç™½è´¨å·¥ç¨‹ï¼ˆé¢„æµ‹-è®¾è®¡-éªŒè¯ï¼‰
- ç²¾å‡†åŒ»ç–—ï¼ˆä¸ªæ€§åŒ–çªå˜æ•ˆåº”é¢„æµ‹ï¼‰
- è¯ç‰©é¶ç‚¹å‘ç°ï¼ˆå¯å¹²é¢„PPIè¯†åˆ«ï¼‰

### 10.3 æœªæ¥ç ”ç©¶æ–¹å‘

**çŸ­æœŸï¼ˆ1-2å¹´ï¼‰**:
1. æ‰©å±•åˆ°æ›´å¤šç‰©ç§ï¼ˆè¦†ç›–ç”Ÿå‘½ä¹‹æ ‘ï¼‰
2. æ•´åˆç»“æ„ä¿¡æ¯ï¼ˆAlphaFoldé¢„æµ‹ï¼‰
3. å¼€å‘ç”¨æˆ·å‹å¥½çš„Webå·¥å…·

**ä¸­æœŸï¼ˆ3-5å¹´ï¼‰**:
1. æ‰©å±•åˆ°å…¶ä»–ç”Ÿç‰©ç½‘ç»œï¼ˆåŸºå› è°ƒæ§ã€ä»£è°¢ï¼‰
2. å¤šæ¨¡æ€æ•´åˆï¼ˆåºåˆ—+ç»“æ„+åŠŸèƒ½ï¼‰
3. ä¸å®éªŒå®¤åˆä½œè¿›è¡Œå¤§è§„æ¨¡éªŒè¯

**é•¿æœŸï¼ˆ5+å¹´ï¼‰**:
1. "é€†å‘å·¥ç¨‹"ç”Ÿå‘½ç³»ç»Ÿï¼šä»åŠŸèƒ½éœ€æ±‚æ¨æ–­åºåˆ—
2. åˆæˆç”Ÿç‰©å­¦ï¼šè®¾è®¡å…¨æ–°PPIç½‘ç»œ
3. è¿›åŒ–æ·±åº¦å­¦ä¹ çš„é€šç”¨æ¡†æ¶

---

## 11. å‚è€ƒæ–‡çŒ®ï¼ˆéƒ¨åˆ†ï¼‰

### è¿›åŒ–ç”Ÿç‰©å­¦
1. Yang, Z. (2007). PAML: Phylogenetic analysis by maximum likelihood. *Molecular Biology and Evolution*.
2. Thornton, J. W. (2004). Resurrecting ancient genes. *Nature Reviews Genetics*.

### å› æœæ¨æ–­  
3. Pearl, J. (2009). *Causality: Models, Reasoning and Inference*. Cambridge University Press.
4. Peters, J., et al. (2017). *Elements of Causal Inference*. MIT Press.

### è›‹ç™½è´¨ç›¸äº’ä½œç”¨
5. Rao, V. S., et al. (2014). Protein-protein interaction detection. *Proteomics*.
6. Browne, F., et al. (2019). Computational prediction of protein-protein interactions. *Bioinformatics*.

### æ·±åº¦å­¦ä¹  + ç”Ÿç‰©å­¦
7. Jumper, J., et al. (2021). AlphaFold 2. *Nature*.
8. Rives, A., et al. (2021). Biological structure and function emerge from scaling unsupervised learning to 250 million protein sequences. *PNAS*.

### å› æœæ¨æ–­ + ML
9. SchÃ¶lkopf, B., et al. (2021). Toward causal representation learning. *Proceedings of the IEEE*.
10. Kaddour, J., et al. (2022). Causal machine learning: A survey. *arXiv*.

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0  
**æœ€åæ›´æ–°**: 2025å¹´10æœˆ  
**ä½œè€…**: Hyperbolic_Bigé¡¹ç›®ç»„  
**è”ç³»æ–¹å¼**: [å¾…æ·»åŠ ]

---

## é™„å½•

### A. æœ¯è¯­è¡¨

- **PPI**: Protein-Protein Interactionï¼ˆè›‹ç™½è´¨ç›¸äº’ä½œç”¨ï¼‰
- **SCM**: Structural Causal Modelï¼ˆç»“æ„å› æœæ¨¡å‹ï¼‰
- **DAG**: Directed Acyclic Graphï¼ˆæœ‰å‘æ— ç¯å›¾ï¼‰
- **ASR**: Ancestral Sequence Reconstructionï¼ˆç¥–å…ˆåºåˆ—é‡å»ºï¼‰
- **ODE**: Ordinary Differential Equationï¼ˆå¸¸å¾®åˆ†æ–¹ç¨‹ï¼‰
- **VAE**: Variational Autoencoderï¼ˆå˜åˆ†è‡ªç¼–ç å™¨ï¼‰

### B. æ•°å­¦ç¬¦å·

- $P_{AB}(t)$: æ—¶é—´$t$æ—¶è›‹ç™½Aå’ŒBçš„ç›¸äº’ä½œç”¨æ¦‚ç‡
- $S_A(t)$: æ—¶é—´$t$æ—¶è›‹ç™½Açš„åºåˆ—çŠ¶æ€
- $\theta_{\text{evo}}$: è¿›åŒ–è¿‡ç¨‹å‚æ•°
- $\theta_{\text{sel}}$: é€‰æ‹©å‹åŠ›å‚æ•°
- $do(X)$: Pearlçš„å¹²é¢„ç®—å­

### C. ä»£ç ä»“åº“ç»“æ„

```
evolutionary-causal-ppi/
â”œâ”€â”€ README.md
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ setup.py
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ collectors/          # æ•°æ®æ”¶é›†è„šæœ¬
â”‚   â”œâ”€â”€ preprocessors/       # æ•°æ®é¢„å¤„ç†
â”‚   â””â”€â”€ loaders/            # DataLoader
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ evolution/          # è¿›åŒ–æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ ancestral.py
â”‚   â”‚   â”œâ”€â”€ neural_ode.py
â”‚   â”‚   â””â”€â”€ coevolution.py
â”‚   â”œâ”€â”€ causal/            # å› æœæ¨¡å—
â”‚   â”‚   â”œâ”€â”€ discovery.py
â”‚   â”‚   â”œâ”€â”€ scm.py
â”‚   â”‚   â””â”€â”€ intervention.py
â”‚   â””â”€â”€ encoders/          # ç¼–ç å™¨
â”‚       â”œâ”€â”€ esm.py
â”‚       â””â”€â”€ tree_lstm.py
â”œâ”€â”€ training/
â”‚   â”œâ”€â”€ trainers.py
â”‚   â””â”€â”€ losses.py
â”œâ”€â”€ evaluation/
â”‚   â”œâ”€â”€ metrics.py
â”‚   â””â”€â”€ visualizations.py
â”œâ”€â”€ experiments/
â”‚   â”œâ”€â”€ baselines/
â”‚   â”œâ”€â”€ ablations/
â”‚   â””â”€â”€ case_studies/
â”œâ”€â”€ notebooks/
â”‚   â””â”€â”€ tutorials/
â””â”€â”€ tests/
    â””â”€â”€ unit_tests/
```

---

**è‡´è°¢**

æ„Ÿè°¢PRINGå›¢é˜Ÿæä¾›çš„é«˜è´¨é‡åŸºå‡†æ•°æ®é›†ã€‚æ„Ÿè°¢ESMå›¢é˜Ÿå¼€æºçš„è›‹ç™½è´¨è¯­è¨€æ¨¡å‹ã€‚

---

**End of Document**
